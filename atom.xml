<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>石锤淡啤酒</title>
  
  <subtitle>生活就是等待戈多</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2026-02-13T07:56:49.580Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Chris Chan</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>2025年终总结</title>
    <link href="http://example.com/2026/02/11/2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"/>
    <id>http://example.com/2026/02/11/2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/</id>
    <published>2026-02-11T15:51:55.000Z</published>
    <updated>2026-02-13T07:56:49.580Z</updated>
    
    <content type="html"><![CDATA[<h2 id="电影-电视剧-读书"><a href="#电影-电视剧-读书" class="headerlink" title="电影&amp;电视剧&amp;读书"></a>电影&amp;电视剧&amp;读书</h2><h2 id="综艺-游戏-博客"><a href="#综艺-游戏-博客" class="headerlink" title="综艺&amp;游戏&amp;博客"></a>综艺&amp;游戏&amp;博客</h2><h2 id="说说新公司"><a href="#说说新公司" class="headerlink" title="说说新公司"></a>说说新公司</h2><p>2025年10月，经过几轮快速的面试和一轮漫长的等待之后，我加入了新公司，也来到了上海生活。但是目前适应下来，总体感觉很bad。</p><p>新公司的硬件和生活设施都是很到位的，除了他们这里的厕所设计都很不科学，屎很容易挂壁，搞得人看着就很恶心之外，其他还真没啥能挑不出来的理。</p><p>但是这家公司和部门里的很多工作配合制度和组织文化是很奇怪的，所以我是很不适应的，这里可能我晚点我会提一个“如何你面试公司”的问题。</p><p>让我先从几个方面说一下，分别是“组织架构”，“SRE文化”，“导师身份”，“团队合作方式”几点：</p><p>首先新公司的组织架构很不清晰，没有可以轻松看到我所在部门整体组织架构的地方，所以你对大部门下的都有哪些业务团队、测试团队，是完全不了解的。自己部门都不了解更别提基础设施的部门了。这样的后果就是：一个告警，有时候很多人在里面忙，你一看他们的组织架构天南海北。但是有时候却一个人都看不到，所以分工很不清晰。我问过一些人，感觉这里关系都不能很清晰的回答。</p><p>其次名片里只能看到这个人的上级，看不到平级。我这个部门下其他的人都有谁不知道，连名都不知道就更别提他们在干什么了，只能靠被动的进入一些群看历史发言和飞书文档。</p><p>然后我想说一下mentor，我的mentor我跟他接触之后，我发现他的能力比我想象的要差，告警的责任心也差，作为sre，7 X 24小时待命响应是必须要做的事儿，但是我感觉可能是机制问题或者什么历史缘故，导致这里其实除了mentor，很多oncall的人都只ack但是只有部分故障会处理。所以我来了之后，发现很多告警都是电话告警，但是真正跟进处理的不多，感觉这里的SRE文化很不严肃很随性。后果就是作为一个新人，都是电话告警，我也不知道哪些应该紧张哪些不应该紧张。带着问题具体问到mentor，他也说不清楚。</p><p>然后就是我跟我的mentor其实做的事情不完全一样，交集只有一部分，那么非交集的那部分，他不能给我什么像样的帮助，导致新人landing的时候很多地方从零开始，踩很多坑。我觉得这个是老板安排工作的失败。</p><p>所以这里又有一个管理的问题，招我进来的老板带了我不到一个月就组织调整离开了。新老板呢，base地又不在上海，导致我跟新老板的交流很少，大量交流都是飞书打字和远程会议，所以这种沟通的不顺利以及对工作方向的不清晰，导致我其实浪费了很多时间。而且这个新老板没有“周会”“周报”这种周期性总结的模式，导致工作群里其实变成了“他不问就没人说话”的一个单向交互群，大家就一年到头给写一个OKR 360环评就没事了。老板在部门的影响力一般，很多东西推动很难。各种各样的飞书卡片没有人看，很多事情都烂尾了。</p><p>合作分工就更难了，大量没有注释的代码。交接过来就不管了，原主人不演示不说明，看到这样的“传帮带”也是心累。</p><p>以上种种，我都切身感受到了新公司landing的痛苦，也明白了他们说的“这里只淘汰人不培养人”。</p><p>所以最后总而言之，回到了一个“如何你面试公司”的问题。我觉得我这一次不爽的跳槽经历之后，其实是给自己上一课的，我的几个心得如下：</p><ol><li>面试的时候，一定问清楚老板跟你的base地的问题，如果不在一起，其实是要三思的。</li><li>问清楚团队有多少人，有多少人是跟你打配合的，分工是什么样（多少人是开发、多少人是运营）？这个团队成立了多久？</li><li>发现mentor不靠谱，就及时止损。多跟老板交流。</li><li>有些事情更改不了，就学会保护自己，但是初出茅庐的你其实也不知道哪些成果是好摘的，所以这部分有撞大运的成分，也有“先接下来在不断加定语偷摸调整”的职场技巧。</li></ol><p>当然我这里也有我反思的地方：</p><ol><li>大家都不说话的地方，积极主动去破冰，腹黑一点说就是“学会把锅甩出去”，证据留好 — “不是我不问，是你没说明白”。</li><li>之前的方法论有问题，因为老东家是让SRE参加故障会，通过故障复盘SRE可以入门学习业务知识。但是这里不是，感觉这里其实的定位就是把SRE做成一个切流的工具人，那么就不需要纠结那么多的业务背景。我有段时间在业务背景上的探索走了弯路。</li><li>主动能动性、积极性很重要。群里多刷脸很重要，这个世界还是会奖励多说话的人。</li></ol><p>当然，新公司也不是完全没有优点，虽然在团队配合和工作文化上我不适应，但是他们的AI tika真的很好用，是我见过最强大的AI！</p>]]></content>
    
    
    <summary type="html">既2024年之后，2025年也是我的一个坎，最近坎有点多，需要调整一下了。</summary>
    
    
    
    <category term="坠乱花天" scheme="http://example.com/categories/%E5%9D%A0%E4%B9%B1%E8%8A%B1%E5%A4%A9/"/>
    
    
    <category term="年终总结" scheme="http://example.com/tags/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"/>
    
    <category term="读书" scheme="http://example.com/tags/%E8%AF%BB%E4%B9%A6/"/>
    
    <category term="电影" scheme="http://example.com/tags/%E7%94%B5%E5%BD%B1/"/>
    
  </entry>
  
  <entry>
    <title>在excel里用k和m来作为单位展示</title>
    <link href="http://example.com/2026/01/13/%E5%9C%A8excel%E9%87%8C%E7%94%A8k%E5%92%8Cm%E6%9D%A5%E4%BD%9C%E4%B8%BA%E5%8D%95%E4%BD%8D%E5%B1%95%E7%A4%BA/"/>
    <id>http://example.com/2026/01/13/%E5%9C%A8excel%E9%87%8C%E7%94%A8k%E5%92%8Cm%E6%9D%A5%E4%BD%9C%E4%B8%BA%E5%8D%95%E4%BD%8D%E5%B1%95%E7%A4%BA/</id>
    <published>2026-01-13T06:14:25.000Z</published>
    <updated>2026-01-13T12:38:20.688Z</updated>
    
    <content type="html"><![CDATA[<p>虽然人类已经进化到“AI这，机器人那”的程度。但是在数据统计区域，excel目前还是那唯一的王。</p><p>不过在excel默认的单元格格式里，是不自带以“k和m这样单位”的数字格式的能力的，那么比如我们想把50000展示成50k，把7000000展示成7m，就要自己写这一段公式了，具体做法如下：</p><p>首先，选择包含要设置格式的数字的单元格，然后选择“单元格格式”。</p><p>然后，在“单元格格式”对话框中的“类别“选择“自定义”，然后在类型里输入：<code>[&lt;999950]0.0,&quot;K&quot;;[&lt;999950000]0.0,,&quot;M&quot;;0.0,,,&quot;B&quot;</code>，请参见屏幕截图：<br><img data-src="/images/excel%E8%BD%AC%E5%8C%96km.jpg" alt="paradin"></p><p>最后，然后点击<code>确定</code>按钮，所有数字均已根据数字格式化为所需格式，请参见屏幕截图：<br><img data-src="/images/excel%E8%BD%AC%E5%8C%96km2.jpg" alt="paradin"></p><p>如果你只想用k这一个单位，同时保留2位小数，那么很简单：<code>0.00,&quot;k&quot;</code>即可，0.00表示小数点后2位，“,”表示i一个comma,即“千”，这是Excel内置语法，1个逗号代表将原始数值自动除以1000。最后补上k这个符号后缀即可。注意，这样仅改变显示样式，不影响单元格实际数值。</p>]]></content>
    
    
    <summary type="html">如果Password authentication is not supported for Git operations，请先去github上检查token是否过期了？</summary>
    
    
    
    <category term="工作与技术" scheme="http://example.com/categories/%E5%B7%A5%E4%BD%9C%E4%B8%8E%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="excel" scheme="http://example.com/tags/excel/"/>
    
  </entry>
  
  <entry>
    <title>打通了《艾尔登法环》</title>
    <link href="http://example.com/2025/09/15/%E6%89%93%E9%80%9A%E4%BA%86%E3%80%8A%E8%89%BE%E5%B0%94%E7%99%BB%E6%B3%95%E7%8E%AF%E3%80%8B/"/>
    <id>http://example.com/2025/09/15/%E6%89%93%E9%80%9A%E4%BA%86%E3%80%8A%E8%89%BE%E5%B0%94%E7%99%BB%E6%B3%95%E7%8E%AF%E3%80%8B/</id>
    <published>2025-09-15T15:01:13.000Z</published>
    <updated>2025-12-31T02:17:28.646Z</updated>
    
    <content type="html"><![CDATA[<p>“老头环”的名声如雷贯耳，其实游戏刚发售的时候我就已经购买了，但是却没有玩下去。可能是碎片化叙事+魂系难度，导致我当时没有好好的感受它。结果最近不知道为啥，短视频给我推了“老头环”的片段，让我燃起了兴趣，正好我面试也结束了，就重新拿起手柄来感受一下当年的最佳游戏。这一摸不要紧，玩了几乎150小时，真是太爽了。</p><p>我基本就是跟着老戴和老迪这两个著名up主的视频攻略走下来的，我也看了一下，《法环》系列都是他俩播放次数最高的B站视频。法环最近热度不减，在B站依旧有不少人直播，可以说，只要这游戏还有人玩，他俩的视频收益就够继续维持下去的。</p><h2 id="先说说剧情"><a href="#先说说剧情" class="headerlink" title="先说说剧情"></a>先说说剧情</h2><p>对我这种非专业的玩家来说，评价一个游戏好与不好主要还是画面和剧情。</p><p>说实话，《法环》的剧情开头玩的我一脸懵，完全不知道为啥见面总要打架，经常俩人见面二话不说就是互殴。但是耐下心去看了看剧情解说和环学家们的分析，觉得这个家族内战还挺有意思的。尤其是本体的“癫火故事线、魔法老师瑟琳故事线、米莉森故事线”都给我很深刻的记忆。</p><p>火山大蛇的故事线就是标准的东亚传统鬼故事的套路：把你吸引进破败老宅，主人表面对你热情周到，其实想害了你。可以说拉卡德我打他的时候是毫无心理压力的，而且它也比较简单，但是火山官邸的地图很阴间。</p><p>这里也多说一下DLC，整个DLC里是没有梅琳娜的，宫崎英高接受采访说“因为不知道玩家在玩DLC时候的进度所以就不考虑梅琳娜的剧情了”。但是游戏里比较灵的设定是让雷妲在一定程度上来担任“女巫”这个角色，但是最后米塔恩前的大混战里，雷妲作为我们的敌对方又肯定要死掉，所以说褪色者天生就是克女巫的，真是一个悲剧的天生属性。</p><p>不过无论是本体还是DLC，跟我们对话的NPC可以说是越到后期越少，玩到最后越玩越孤独，我想这也是剧本安排的一个刻意点。所以每次开了新周目，看到这些NPC又回来了，虽然可能还是敌对方但是至少他们人站在那里还是挺让人唏嘘的。</p><p>我想这个可能是“无任务系统”的优势吧，逼迫玩家自己去深探索或者去网站跟同好交流。其实单机游戏用这种方式来让玩家达到社交的目的也是一个新的设计思路，而且法环还支持朋友联机PK或者打BOSS，也算是半个网络游戏了。</p><h2 id="再说说其他设计"><a href="#再说说其他设计" class="headerlink" title="再说说其他设计"></a>再说说其他设计</h2><p>法环的美术团队很给力，很多画面做的不错。完美满足了非魂类玩家对西方剑与魔法的幻想。而且BOSS们的特效效果很酷炫，以“电子斗蛐蛐”的角度去看，真的体会到了众神互殴的壮观。不过也正是上面我说的大多数场景都是“二话不说就互殴”，这也会导致会出现“杀掉你见面的NPC，进而导致支线断掉”。我还记得我二周目出来就把白面具宰了，结果直到大后期才去了蒙格温王朝。</p><p>魂游著名的箱庭设计这里不多说了，而且很多墓地还加上了“鬼打墙”的设定，让玩家更是一遍骂一遍惊叹不已。</p><p>除了地形设计，游戏的重心还是战斗。法环的战技是没有CD的，但是有些会有后摇，比较明显的就是名刀月影，我就是因为后摇控制的不好，导致每次名刀月影的节奏总是把握不好。我一周目开始走的是力量流派，后来发现感应出血流DPS真猛啊，果断洗了点。二周目又试了试远程法师，帚星是个好东西。</p><p>整体游戏的战斗流派还是很多，而且彼此之间其实没有那么大的差别，用力量流可以通关，转型当了信仰祷爷流说不定打的会更爽。这种对各种流派的平衡也是战斗团队设计的很不错的地方。</p><p>而且法环加入了骨灰这个设定，这是相比较黑魂系列，老贼最大的怜悯。有了T0级别的骨灰以很大程度避免了“我这种凑热闹的玩家”受苦，极大的增加了新人过关的概率，怪不得法环出圈了。</p><p>作为开放游戏，法环本体的地图可以说是非常庞大的，几乎就是一个网络游戏的地图。可以说在初期给了玩家巨大的震撼，走着走着总会有一个新的山洞。但是随着探索的深入，再大的地图总会有探索完毕的那一刻。我后期就专注于打BOSS和精英怪了，很多小怪其实完全没有什么心情和耐心去战斗了，这几点应该都是开放世界玩到后期的玩家普遍心态吧。<br><img data-src="/images/%E6%B3%95%E7%8E%AF1.jpg" title="游戏美工真的没话说，而且把神之门安排在贝瑞特也是一个残酷的妙笔"></p><h2 id="我的成王记录"><a href="#我的成王记录" class="headerlink" title="我的成王记录"></a>我的成王记录</h2><p>我第一周目开始的时候走的就是力量+灵巧路线，直到拿到了粉碎巨人锤，就开始坚定的走向了纯力量的莽夫路线，一周目通关70%的时间拿巨人锤，20%的时间拿名刀月影过关的，剩下10%特殊场合特殊对待。骨灰的话基本就是大哥带我飞，结局也毫无疑问的选择了癫火之王的路线。</p><p>不过一周目死了也大约有个1000次吧…</p><p>二周目时候开头我COS嘎子哥，上来就直接去拿了巨剑然后搭配狮子斩砍来砍去，总体来说还是没有跳出力量流的玩法。后来改用了尸山血海，原因是蒙格卡了我很久，后来发现拿尸山血海的感觉比巨剑好很多。于是尸山血海就成了我二周目的主要武器，二周目折磨我最久的是女武神和黑剑，他俩加起来几乎打了6个小时，古龙桑克斯也有2个小时了。反倒是荷莱露，我2~3次就过了，毕竟是正义的三打一（如果颠火的话还有夏波利利助阵，那就是四打一了）。拉达冈和皮蛋本身也弱火和出血，没费太大劲就过了。</p><p>二周目我选的是金面具黄金律法修复结局。</p><p>DLC可能是我等级不低的原因（250级去的DLC，最后幽影树碎片15、灵灰8个），几个BOSS都过得不太难，只有指头之母卡了我大约1个多小时，剩下几个包括米塔恩都没有超过5次，可能是骨灰太强力吧。我DLC开始的骨灰就是黑刀大姐，后来换成了黑骑士姐妹花，到了米塔恩换成了大铁匠，话说大铁匠真的猛，我觉得它比大哥还大哥，而我就是一个无耻抱大腿的。</p><p>但是DLC小怪还是很猛的，我死在小怪的次数很多很多。DLC我推图的主力武器就是“玛利卡的小锤”，战技霸体且输出不低，但是既然霸体强也肯定面临大量的换血，如果小怪扎堆的话，很多场合都是被换血换死的。</p><p>不过结合剧情我倒是有一个疑问，法环里规定一个神搭配一个王，但是如果在非菈妮结局里，成为了艾尔登之王的我，对应的神是哪位？当然也有可能这是刻意的安排，因为玛莉卡的本意应该就是“打破例行，世界不应该有神，只有王就够了”。</p><p>后来我又开了一个新号，重走了一遍一周目，不过这次走的是法师路线，开局陨石术砸来砸去，后来换成了帚星舒服了不少，但是法师有一点比较难受就是如果被偷袭就很被动，而且后期尤其DLC的怪都是韧狗，很难打断对应的动作所以法师要是后手就很难受。<br><img data-src="/images/%E6%B3%95%E7%8E%AF2.jpg" title="不晓得将来法环会不会考虑多加一点衣服，把夜环的一些衣服可以加进来呀"></p><h2 id="玩的不爽的地方"><a href="#玩的不爽的地方" class="headerlink" title="玩的不爽的地方"></a>玩的不爽的地方</h2><p>首先任何产品都有不完美的一面，对我个人来说《艾尔登法环》吐槽的地方是以下几点：</p><ol><li>DLC很多场景太黑，亮度调到最高也看不清，眼睛非常吃力。我后来恨不得拿光明剑的战技来照明。后来新号我就一路常驻魔法照亮。</li><li>DLC和本体后期（雪山），里面很多怪的设定就是纯恶心人，增加了秒杀&#x2F;不能攻击的设定，完全就是变种的泥头车。</li><li>有些怪物的设定太阴间、而且背景音乐也不舒服。很多墓地和山东80%的时间都是在恐怖探险。</li><li>《法环》本体大陆售价298可能卖便宜了，350元也不为过，但是DLC 198实在是卖贵了，说实话也就值128的水平。</li><li>本体和DLC都有很明显的赶工痕迹：本体开头做的非常好，尤其是史东薇尔，每次逛都会有新发现，结果到了雪山空旷了一大片，就是跑步还没什么景色好看。DLC更甚，整个地图的东北方啥都没有，你哪怕放点大红熊让大家打打也行啊。而且从剧情来说，为啥巨人铁锅烧了后，我就去了天空之城？这段剧情就这么摆烂留白了么？</li><li>战斗中隐藏头盔这个功能做出来就这么费劲吗？</li><li>马和装备换颜色这个功能做出来就这么费劲吗？</li><li>找一个好的中文翻译就这么费劲吗？</li></ol><p><img data-src="/images/%E6%B3%95%E7%8E%AF3.jpg" title="沉迷捏脸无法自拔"><br>不过虽然有一些玩的不爽的地方，总体来说《法环》跟《只狼》一样，都是一个艺术品，这里我很佩服宫崎英高，能把西方故事和东方故事都讲的很好，这个本事真的很厉害！</p>]]></content>
    
    
    <summary type="html">在离职期间我把法环打通了两遍...</summary>
    
    
    
    <category term="坠乱花天" scheme="http://example.com/categories/%E5%9D%A0%E4%B9%B1%E8%8A%B1%E5%A4%A9/"/>
    
    
    <category term="魂系游戏" scheme="http://example.com/tags/%E9%AD%82%E7%B3%BB%E6%B8%B8%E6%88%8F/"/>
    
    <category term="单机游戏" scheme="http://example.com/tags/%E5%8D%95%E6%9C%BA%E6%B8%B8%E6%88%8F/"/>
    
  </entry>
  
  <entry>
    <title>通过调整jmv参数，有效提升系统可用率</title>
    <link href="http://example.com/2025/07/25/%E9%80%9A%E8%BF%87%E8%B0%83%E6%95%B4jmv%E5%8F%82%E6%95%B0%EF%BC%8C%E6%9C%89%E6%95%88%E6%8F%90%E5%8D%87%E7%B3%BB%E7%BB%9F%E5%8F%AF%E7%94%A8%E7%8E%87/"/>
    <id>http://example.com/2025/07/25/%E9%80%9A%E8%BF%87%E8%B0%83%E6%95%B4jmv%E5%8F%82%E6%95%B0%EF%BC%8C%E6%9C%89%E6%95%88%E6%8F%90%E5%8D%87%E7%B3%BB%E7%BB%9F%E5%8F%AF%E7%94%A8%E7%8E%87/</id>
    <published>2025-07-25T03:50:10.000Z</published>
    <updated>2025-11-08T00:48:24.695Z</updated>
    
    <content type="html"><![CDATA[<h2 id="背景说明"><a href="#背景说明" class="headerlink" title="背景说明"></a>背景说明</h2><p>组内有一个业务系统 A，日常能达到十万级QPS（大促峰值超40WQPS），且上游系统基于同步调用，对RT非常敏感（毫秒级返回）。因此系统A不能轻易抖动，需要在超高流量下保持极致的服务稳定性：<br><img data-src="/images/jvm1.png" alt="paradin" title="调用关系很简单，但是对抖动的要求很高"></p><p>某天发现上游系统有一些报错，找过来需要我们排查解决：<br><img data-src="/images/jvm2.png" alt="paradin" title="RT跟qps的曲线几乎相同，可见就是抖动导致的"></p><h2 id="排查过程"><a href="#排查过程" class="headerlink" title="排查过程"></a>排查过程</h2><h3 id="初步分析"><a href="#初步分析" class="headerlink" title="初步分析"></a>初步分析</h3><p>查看上游系统报错日志，发现全都是同步调用请求超时，报错<code>TimeoutException</code>。因此需要重点分析系统A是否有异常。<br>首先，在报错时间段业务流量并没有明显上涨，系统 A 的CPU水位、机器load也没有明显异常，因此可初步排除由于流量激增、超出系统最大负载所致。<br>其次，系统 A 执行请求的过程全都是一些内存计算逻辑，不需要远程调用数据库、中间件、外部系统，因此也可排除是外部依赖服务抖动&#x2F;有瓶颈导致。<br>其次，虽然系统 A 的并发流量很高（单机高达数千 QPS），但每条请求之间不涉及同步&#x2F;互斥的单机&#x2F;分布式锁逻辑，因此也可排除由于锁导致请求等待超时所致。<br>经过以上初步分析，已排除流量激增、外部服务有瓶颈、并发锁等可能影响因素，但并未定位到根因，需要进一步深入分析。</p><h3 id="定位根因"><a href="#定位根因" class="headerlink" title="定位根因"></a>定位根因</h3><p>查看系统日志，发现服务抖动期间，该系统曾发生过一次热数据发布（系统索引切换）：<br><img data-src="/images/jvm3.png" alt="paradin" title="系统 A 在内存中加载了一份索引（可简单理解为一个比较复杂的大对象&#x2F;数据结构），且系统 A 会不定期（最快每 15 分钟）更换旧索引、加载最新版本索引"></p><p>已知本系统的索引较大（约 0.5G），由于索引切换过程会产生大量新对象和内存垃圾，因此高度怀疑服务抖动与 GC 强相关。查看 <code>gc.log</code>，在系统抖动期间果然发现了长耗时的 YGC：<br><img data-src="/images/jvm4.png" alt="paradin" title="Object Copy：GC 时不再使用的对象会被清理释放，并整理剩余存活对象，整理过程存活对象会被复制到内存中新的位置"></p><p>观察日志可发现<code>Object Copy</code>环节耗时明显异常，高达200ms，且本过程会<code>STW（Stop The World）</code>。因此服务抖动的根本原因已锁定：<code>系统A加载的索引非常大，导致 YGC 时索引在堆内存的复制过程耗时久，复制期间业务线程被长时间暂停，导致上游请求大量超时报错</code>。</p><h2 id="优化过程"><a href="#优化过程" class="headerlink" title="优化过程"></a>优化过程</h2><h3 id="常规思路"><a href="#常规思路" class="headerlink" title="常规思路"></a>常规思路</h3><p>针对 GC 暂停久这类常见问题，有如下一些常规优化思路：<br><img data-src="/images/jvm5.png" alt="paradin" title="这些思路都是面试时候可以拿来装逼的材料"></p><p>然而，以上方法在本次场景中大多不适用。首先经排查代码并不存在Bug，且索引体积已无更多压缩空间，且索引算法层面并不支持增量式更新只能全量更替。其次，加机器虽然能通过稀释单机请求量，让 STW 长暂停影响到的请求量更少，但并未从根本解决问题，且会导致机器资源大量浪费。另外使用堆外内存虽然可不受 GC 管理，但高频访问下序列化&#x2F;反序列化开销无法容忍。</p><p>因此，综合来看只能考虑在 JVM 参数方面做优化：通过修改参数调整 JVM 的行为模式，让索引复制带来的负面影响尽可能小，保障服务高可用。</p><h3 id="详细分析GC日志"><a href="#详细分析GC日志" class="headerlink" title="详细分析GC日志"></a>详细分析GC日志</h3><p>根据 “定位根因” 那一段的分析，问题已归因为<code>YGC Object Copy</code>阶段复制索引时耗时太久，导致上游请求超时报错。本节进一步详细分析 GC 日志，更细粒度还原整个 GC 过程，探索有无潜在优化点。<br>已知当前 JVM 核心参数如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-Xms12g</span><br><span class="line">-Xmx12g</span><br><span class="line">-XX:MetaspaceSize=512m</span><br><span class="line">-XX:MaxMetaspaceSize=512m</span><br><span class="line">-XX:+UseG1GC</span><br><span class="line">-XX:G1HeapRegionSize=16M</span><br><span class="line">-XX:MaxGCPauseMillis=100</span><br></pre></td></tr></table></figure><p>通过集团 ATP 工具对原始 GC 日志进行可视化分析，下图中标出了各 GC 事件的时间点和变化曲线：<br><img data-src="/images/jvm6.png" alt="paradin" title="grace-parser 对于分析堆和线程栈是一个好东西"></p><p>从图中可以分析出如下信息：<br>① 蓝色圆点：一个点代表一次 YGC，横轴上堆满了密密麻麻的蓝点，说明 YGC 发生非常频繁且耗时短，毫秒级即可完成清理，这是理想中的情况。符合预期<br>② 粉色折线：代表堆内存占用量的变化情况，可以看到整体呈锯齿形，不断快速上升和下降。由于系统流量较大且请求执行过程会不断产生一些朝生夕灭的临时对象，因此可看到粉色折线快速上升。当 Eden 区不足时触发 YGC 清理，内存释放完成即可看到粉色折线下降到低点。符合预期<br>③ 异常蓝点：远离横轴说明耗时久，它们就是刚刚在日志中手动找到的长耗时 YGC 记录。需重点关注<br>④ 紫色折线：代表老年代堆内存占用量的变化情况。相比之下老年代占用率上涨缓慢，因为大多数临时对象都在年轻代被清理掉了，不会进入老年代。然而观察发现每次长耗时 YGC 蓝点附近，都会伴随着紫色折线阶梯式上升。需重点关注</p><p>其次，还可发现长耗时YGC往往是成对出现的，有如下规律：<code>成对出现、时间接近、耗时都长、第一次晋升量少、第二次晋升量多</code>，如下图所示：<br><img data-src="/images/jvm7.png" alt="paradin" title="可见每次切换索引就超时抖动"></p><p>综上，整合目前所有已知线索：系统在每次切换索引时，都会超时抖动，且在抖动时间点会发现连续的两次长耗时 YGC（第二次 YGC 晋升量大）。</p><p>经分析以上现象符合预期，详细过程推演还原如下：<br><img data-src="/images/jvm8.png" alt="paradin" title="gc原理"></p><p>● 阶段一：系统创建新索引，相关对象默认被分配至 Eden 区<br>● 阶段二：Eden 区空间不足，触发第一次 YGC，此时新索引被复制（Object Copy）到 Survivor 区，耗时久<br>● 阶段三：新索引构造完成，并被 GcRoot 引用上，旧索引与 GcRoot 引用被断开<br>● 阶段四：系统持续处理外部请求，Eden 区空间再次不足，触发第二次 YGC，此时旧索引被清理。新索引又被复制（Object Copy）到 Old 区（晋升），耗时久<br>● 阶段五：后续即使外部流量再次把 Eden 区打满，YGC 也能毫秒级快速完成。因为只需快速清理临时对象即可，新索引已稳定在老年代不会再被腾挪复制</p><h3 id="一些尝试"><a href="#一些尝试" class="headerlink" title="一些尝试"></a>一些尝试</h3><p>至此，问题原因已非常清晰：每次新生成的索引会随着YGC连续复制多次，复制过程暂停久导致系统抖动。因此可考虑基于如下一些思路来针对性优化本问题，后文会逐个详细解释：<br><img data-src="/images/jvm9.png" alt="paradin" title="这几个参数又是给你面试装逼的资源"></p><h4 id="让索引尽早晋升到老年代"><a href="#让索引尽早晋升到老年代" class="headerlink" title="让索引尽早晋升到老年代"></a>让索引尽早晋升到老年代</h4><p>通常情况下，一个对象最初会被分配在 Eden 区，第一次 YGC 后进入 Survivor 区。此后每次 YGC 对象会在 S0 和 S1 之间反复腾挪，且每次腾挪后对象 age+1，当 age 大于默认阈值时会晋升到 Old 区。因此对象在堆内存中的流转路径是：<code>Eden =&gt; S0 =&gt; S1 =&gt; S0 =&gt; S1 =&gt; ... =&gt; Old</code>。</p><p>由于本例中索引对象复制开销太大，因此可考虑让索引尽早晋升到老年代，避免在年轻代反复腾挪影响系统稳定性。有如下 JVM 参数可以达到此目的：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MaxTenuringThreshold参数作用：表示对象在晋升到老年代之前，在年轻代中最多能够承受的 GC 周期次数</span><br></pre></td></tr></table></figure><p>然而，结合上面 GC 日志截图可知，G1GC 对大对象做了动态优化——直接晋升（Direct Tenuring），并没有让索引在 Survivor 内反复腾挪。索引实际流转路径是：<code>Eden =&gt; S0 =&gt; Old</code>，总共只涉及 2 次复制而非默认值 15 次。此时相当于已经默认设置了 <code>MaxTenuringThreshold=1</code>，流程如下：<br>● 阶段一：新索引分配至 Eden 区，此时 age&#x3D;0<br>● 阶段二：触发第一次 YGC，索引存活，由于 age &lt; MaxTenuringThreshold &#x3D; 1，此时索引从 Eden 复制到 S0，随后 age 增长为1<br>● 阶段三：触发第二次 YGC，索引仍存活，此时由于 age &#x3D; MaxTenuringThreshold &#x3D; 1，则直接晋升并复制到 Old</p><p>于是手动设置 <code>MaxTenuringThreshold=1</code> 重新实验。如下图所示，经实测索引流转路径仍然是 Eden &#x3D;&gt; S0 &#x3D;&gt; Old，证明以上猜想成立：<br><img data-src="/images/jvm10.png" alt="paradin" title="直接晋升"></p><p>那能否更极端一点呢？让索引直接从 Eden 复制到 Old 而完全不经过 Survivor 区？因为<code>Eden =&gt; Old</code>相比<code>Eden =&gt; S0 =&gt; Old</code>，复制次数从 2 次进一步压缩为 1 次，总暂停时间直接减半，系统稳定性预期将提升明显。因此考虑进一步设置 <code>MaxTenuringThreshold=0</code>，预期流程如下：</p><p>●阶段一：新索引分配至 Eden 区，此时 age&#x3D;0<br>●阶段二：触发第一次 YGC，此时由于 age &#x3D; MaxTenuringThreshold &#x3D; 0，则索引直接晋升并复制到 Old</p><p>实验结果如下图，可知索引的确在第一次 YGC 时从 Eden 被直接复制到了 Old（因为清理后年轻代占用变为 0，否则年轻代清理后仍然会占用 400MB 左右）<br><img data-src="/images/jvm11.png" alt="paradin" title="直接晋升"></p><p>总结：本次优化前，每次索引切换后会出现2次连续的长耗时YGC，在不改任何一行业务代码、不加一台机器的前提下，仅通过设置 <code>MaxTenuringThreshold=0</code>，GC 长暂停时间直接减半。体现在系统监控上就是索引切换时报错量明显变少，服务抖动时成功率从 95% 提高至 98%：<br><img data-src="/images/jvm12.png" alt="paradin" title="不走s区，直接去old"></p><h4 id="InitialTenuringThreshold"><a href="#InitialTenuringThreshold" class="headerlink" title="InitialTenuringThreshold"></a>InitialTenuringThreshold</h4><p>经实测，设置 <code>InitialTenuringThreshold=1</code> 也能达到类似上面的效果，也能将索引复制次数从 2 次减少为 1 次，提高系统稳定性：<br><img data-src="/images/jvm12.png" alt="paradin" title="InitialTenuringThreshold和MaxTenuringThreshold的作用类似，都是用于调整对象晋升到老年代的年龄阈值"></p><h4 id="AlwaysTenure"><a href="#AlwaysTenure" class="headerlink" title="AlwaysTenure"></a>AlwaysTenure</h4><p>AlwaysTenure参数作用如字面含义：让对象总是晋升。经实测，设置 AlwaysTenure 后，也能将索引复制次数从 2 次减少为 1 次，提高系统稳定性：<br><img data-src="/images/jvm14.png" alt="paradin" title="AlwaysTenure 参数也能达到该目的"></p><p>这里多说明一下：<br>● 由于索引较大，Eden 区剩余空间可能无法容纳整个索引，因此上图总共经历了 3 次 YGC 清理释放，才让索引全部创建完成。其中每次 YGC 会把已构造好的索引局部晋升到老年代，前后总共 3 次 YGC 才把索引完整搬到了老年代。这与“AlwaysTenure 将索引复制次数从 2 次减少为 1 次”结论并不冲突。</p><p>● AlwaysTenure 相当于只使用 Eden 和 Old，而 Survivor 闲置。与之作用相反的参数是 NeverTenure，会让对象在年轻代中反复辗转而永远不晋升，意味着只使用了 Eden 和 Survivor 区，而 Old 区闲置。两个参数都比较极端，【只有在特殊业务场景才考虑使用】。</p><p>● 降低晋升年龄阈值会让对象更容易进入老年代，但是会加重老年代 FGC 负担。而本业务场景比较特殊，对象的存活时间两极分化明显：一种是由 RPC 请求产生的朝生夕灭的对象，存活时间毫秒级；另一种则是巨型索引对象，存活时间最短都有数十分钟。因此就算把晋升年龄阈值改为1，这些临时对象大概率已失活（被清理）而非存活（被晋升），故修改以上 JVM 参数不会加重本系统FGC负担。</p><h4 id="让索引直接分配到老年代"><a href="#让索引直接分配到老年代" class="headerlink" title="让索引直接分配到老年代"></a>让索引直接分配到老年代</h4><p>上节内容已将索引流转路径已从<code>Eden =&gt; Survivor =&gt; Old（2 次复制）</code>优化为 <code>Eden =&gt; Old（1 次复制）</code>。能否更极端一点，让新索引在最初创建时，就一步到位直接分配到老年代（0 次复制）？思路如下：<br><img data-src="/images/jvm15.png" alt="paradin" title="这样索引复制导致服务抖动的问题将得到根治"></p><p>围绕此思路，继续做了如下尝试：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PretenureSizeThreshold 参数作用：当对象的大小超过 PretenureSizeThreshold 时，该对象会直接分配到老年代</span><br></pre></td></tr></table></figure><p>然而 PretenureSizeThreshold 参数对 G1GC 并不生效，实测也发现调整该参数后没有稳定性增益。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G1HeapRegionSize 参数作用：G1GC 将堆内存划分为多个大小相等的区域，这些区域被称为 Region，旨在提高垃圾收集的效率和灵活性。当待分配对象大小 &gt; G1HeapRegionSize / 2 时，会被直接分配到老年代</span><br></pre></td></tr></table></figure><p>修改 G1HeapRegionSize 参数后继续观察，索引切换时系统仍然抖动，看 GC 日志索引流转路径仍然是 <code>Eden =&gt; Survivor =&gt; Old</code>，并没有达到预期效果。</p><p>原因分析：业务上索引虽然整体很大（约500MB），但实际是由上百万个小对象组成的。索引的创建过程实际就是内部海量小对象逐个创建的过程，这些小对象被分配至 Eden（而非 Old）是合理的、符合预期的，因此从结果来看整个索引实际仍然被分配在 Eden 区。除非是 int[] arr &#x3D; new int[1000000000] 这类情况，JVM 能在最初明确知道 arr 需要多少空间，才可直接分配到老年代。</p><h4 id="加速索引复制过程"><a href="#加速索引复制过程" class="headerlink" title="加速索引复制过程"></a>加速索引复制过程</h4><p>在不改变索引固有大小、索引复制次数的情况下，也可以考虑调节如下参数来提高复制速度、降低暂停时长：<br><img data-src="/images/jvm16.png" alt="paradin" title="这几个参数也都挨个试过"></p><p>实测调整以上参数无明显改善：MaxGCPauseMillis 只是一个目标值，然而复制索引固有耗时始终有那么久，作用不大。其次，经实测 GC 默认并发线程数已接近 CPU 核数，也无更多优化空间。</p><h4 id="升级JDK11-ZGC"><a href="#升级JDK11-ZGC" class="headerlink" title="升级JDK11 - ZGC"></a>升级JDK11 - ZGC</h4><p>传统的CMS和G1都存在各自的理论局限（例如CMS的内存碎片化，G1只能在STW时移动对象，两者STW时长会随着活跃对象的增加而增加），这正是我们大索引复制所遇到的问题。</p><p>JDK11 中新增 ZGC，核心变化是引入了着色指针（Colored Pointers）和读屏障（Load Barriers）机制，解决对象复制过程中准确访问对象的问题，从 STW 优化为并发转移。核心原理如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZGC中业务线程访问对象将触发“读屏障”，如果发现对象被复制移动了（通过“着色指针”实现），则“读屏障”会把读出来的指针更新到对象的新地址上，让业务线程始终访问到对象更新后、移动后的正确地址。对比之下G1只能先暂停并复制对象、更新指针地址，随后再解除暂停让业务线程访问对象</span><br></pre></td></tr></table></figure><p>以上机制让 ZGC 可以有更高的并发度、更低的 STW 时长。对比 G1 如下：<br><img data-src="/images/jvm17.png" alt="paradin" title="ZGC vs G1"></p><p>经实测使用 ZGC 后稳定性有提升，但索引切换期间仍然会有轻微抖动。诊断分析 GC 日志发现此期间有 Allocation Stall（导致应用程序在尝试分配内存时暂时停止，直到有足够的内存可用）：<br><img data-src="/images/jvm18.png" alt="paradin" title="ZGC还是有点效果的"></p><p>本系统每次分配新索引都需要约 500MB 内存，这是 JVM 无法预知的。对比监控可发现每次索引切换时，每个服务端 RT 尖刺均对应了一次堆内存占用尖刺，如下图：<br><img data-src="/images/jvm19.png" alt="paradin" title="时间轴都对得上"></p><p>由于 ZGC 在内存整理阶段是无锁复制，因此 GC 日志中没再发现耗时异常的记录，经实测服务成功率进一步提高到了 99.5%。但美中不足的是由于 Allocation Stall 问题，系统时常还是会有些小抖动。</p><h2 id="问题复盘"><a href="#问题复盘" class="headerlink" title="问题复盘"></a>问题复盘</h2><p>回顾本问题，复盘为什么YGC的负面影响这么大，让本系统在索引切换时成功率跌至95%？核心问题是本系统挑战本身就非常大，需要同时满足以下三个条件，缺一不可：<br>● 对延迟非常敏感：同步调用且毫秒级返回，不能长时间暂停，否则每次长暂停都会直接体现为业务监控上的报错<br>● 极高的内存压力：每次索引切换会带来 GB 级的内存消耗、清理和复制开销，这是导致 YGC 耗时久的根源<br>● 极高的并发量：总流量十万级 QPS，单机数千 QPS。GC 暂停时所有请求都将暂停处理，导致大量超时<br><img data-src="/images/jvm20.png" alt="paradin" title="维护这么难得的系统也是一个挺有挑战的事儿"></p><p>由此可见，针对组内某个高并发（10W+ QPS）、低延迟（毫秒级返回）、高内存压力（最快每 15 分钟一次 GB 级索引切换）系统的不稳定问题，可以尝试基于 JVM 调参做了一系列探索尝试，最终彻底实现了索引无感切换，让服务可用率稳定在 99.995%。经测试有效的优化手段如下：<br><img data-src="/images/jvm21.png" alt="paradin" title="最后总结一下"></p><p>至此，未来无论系统 QPS 涨到多高、索引体积膨胀到多大、索引切换多么频繁，系统都能无感切换索引，稳定性不再受到任何影响。完结撒花~</p>]]></content>
    
    
    <summary type="html">这不是我的原创，是对学习java的gc过程很有好处，所以赶紧钻研学习</summary>
    
    
    
    <category term="工作与技术" scheme="http://example.com/categories/%E5%B7%A5%E4%BD%9C%E4%B8%8E%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="java" scheme="http://example.com/tags/java/"/>
    
    <category term="gc" scheme="http://example.com/tags/gc/"/>
    
    <category term="系统调优" scheme="http://example.com/tags/%E7%B3%BB%E7%BB%9F%E8%B0%83%E4%BC%98/"/>
    
  </entry>
  
  <entry>
    <title>从中国女篮看中国体育</title>
    <link href="http://example.com/2025/07/22/%E4%BB%8E%E4%B8%AD%E5%9B%BD%E5%A5%B3%E7%AF%AE%E7%9C%8B%E4%B8%AD%E5%9B%BD%E4%BD%93%E8%82%B2/"/>
    <id>http://example.com/2025/07/22/%E4%BB%8E%E4%B8%AD%E5%9B%BD%E5%A5%B3%E7%AF%AE%E7%9C%8B%E4%B8%AD%E5%9B%BD%E4%BD%93%E8%82%B2/</id>
    <published>2025-07-22T09:44:50.000Z</published>
    <updated>2025-11-08T00:47:31.401Z</updated>
    
    <content type="html"><![CDATA[<h2 id="篮球选材的困境"><a href="#篮球选材的困境" class="headerlink" title="篮球选材的困境"></a>篮球选材的困境</h2><p>中国女篮在亚运会上被日本队淘汰，在8个队伍里最后拿到了第三。拿到铜牌后，赛前嘲讽日本主教练的宫鲁鸣赛后给自己打了一个及格分。</p><p>再加上U19女篮52-115被加拿大女篮暴揍一顿，女篮领导们的血压估计飙到了峰值。不过幸好大运会的女篮连克日本美国等意识形态对手，让领导们舒服了一点。</p><p>现在女篮跟男篮一样，走的还是建国初的路子：仗着14亿人口地大物博，然后从体校找几个大个子，然后搭配几个后卫来伺候这几个大个子。这几个大个的能力在篮球水平比较贫瘠的亚洲还算能吃得开，不过随着现代篮球越来越快、中锋要更多去弧顶发牌的趋势，而且最重要的是澳大利亚男女篮归入了亚洲杯范围，我想再不更换选材思路，以后无论是男女篮想染指亚洲杯是一个挺难的事儿。</p><p>从最早的“为什么刘伟就是中国第一后卫”这个问题现在具象化了，演变成“为什么中国出不来河村勇辉，为什么中国出不来田中心”。因为我们的选材眼光就是这样，有姚明的“先进经验”，那就保守主义继续看天由命等下一个姚明呗。</p><p>不过，这里我个人想表达一个观点：女篮这项运动是一个观赏性很差的运动。三大球里女排是非常展现女子曲线美的运动，女足的运动员也绝大多数都是苗条的模特身材。唯独女篮，身材普遍偏壮，而且女篮比赛里也有不少倒地争抢的镜头，就难免有点“连滚带爬”，有种菜市场女子互殴的场面。所以真的不要怪女篮球员工资低，因为实在很难看，要不是为了性别平等，这个项目其实真的可以取消，因为实在吸引不来什么金主。</p><h2 id="中国人不善快速决策？"><a href="#中国人不善快速决策？" class="headerlink" title="中国人不善快速决策？"></a>中国人不善快速决策？</h2><p>杨毅曾经在他的播客里说过“中国奥运金牌项目集中于小巧难女少”（小是小球，巧是技巧项目，难是难度大，女是女子项目，少是参与人数少）。随着女篮这次在亚洲杯折戟沉沙，让人不禁思考，是不是“需要快速做决策的团队运动也是中国人不擅长的？”</p><p>比如足球、篮球这些团队配合的PVP项目，是需要快速决策的，当你面对一个对手是传球还是单打？传球的话是击地传球更好还是吊高球传给他？这些都是要运动员在电光火石之间快速做出判断，然后再搭配平时的基本功做到高成功率的动作。</p><p>而相比较举重、体操、游泳、跳水、射击这种，本身就不是PVP的项目，也压根跟不上什么决策，只要够重、够快或者按照评分标准上的要求去做就肯定能拿高分。斯诺克、围棋这种，虽然它是PVP项目，但是他不需要“快速决策”。至于“乒乓球、羽毛球”这些PVP项目，但是最多2个人配合，涉及不到团队配合。</p><p>这么一看“需要快速做决策的团队运动是中国人不擅长的”这个结论好像是有道理的，毕竟从事实来看，根据巴黎奥运会的奖牌分布<a href="https://www.olympics.com/zh/news/paris-2024-team-china-medalists-overview">https://www.olympics.com/zh/news/paris-2024-team-china-medalists-overview</a> ，不难发现除了女子曲棍球拿了银牌，其他所有奖牌基本都是少于等于2人的项目。</p><p>那么为啥会这样？我想首先“小巧难女少”这五个字很完美的概括了“举国体制”优势。当然这个优势有也不是啥坏事，但是现在的情况是“举国体制”的优势再缩小，而且“市场化高”的运动我们也没有发展起来，而且是不仅发展了好几年没发展起来，倒是发展出来不少贪污犯。我觉得可能主要问题是“市场化高”的运动，需要大量的随机应变即兴发挥，因为这个就是吸引目光的地方，吸引来了目光也吸引来了钱，很多球员都是靠“灵气”吃饭的，但是中国的教育太死板，很难培养出这样的人。</p><p>B站有几个经常分析日本体育的UP主，通过他们感觉到日本的体育目前发展的势头不错，无论是女子100米栏、男子100米、男排、女排最近都有冠军入账，而且他们的乒乓球也没有广大群众想的那么差，大阪直美现在明显比郑钦文能打，所以有些项目中国要维持亚洲霸主还是要小心一点。</p>]]></content>
    
    
    <summary type="html">三大球的黑暗期还要很久</summary>
    
    
    
    <category term="坠乱花天" scheme="http://example.com/categories/%E5%9D%A0%E4%B9%B1%E8%8A%B1%E5%A4%A9/"/>
    
    
    <category term="体育" scheme="http://example.com/tags/%E4%BD%93%E8%82%B2/"/>
    
    <category term="篮球" scheme="http://example.com/tags/%E7%AF%AE%E7%90%83/"/>
    
    <category term="奥运会" scheme="http://example.com/tags/%E5%A5%A5%E8%BF%90%E4%BC%9A/"/>
    
  </entry>
  
  <entry>
    <title>为什么我开始主动消费降级</title>
    <link href="http://example.com/2025/06/25/%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E4%BB%AC%E5%BC%80%E5%A7%8B%E4%B8%BB%E5%8A%A8%E6%B6%88%E8%B4%B9%E9%99%8D%E7%BA%A7/"/>
    <id>http://example.com/2025/06/25/%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E4%BB%AC%E5%BC%80%E5%A7%8B%E4%B8%BB%E5%8A%A8%E6%B6%88%E8%B4%B9%E9%99%8D%E7%BA%A7/</id>
    <published>2025-06-25T07:28:38.000Z</published>
    <updated>2025-11-08T00:47:28.705Z</updated>
    
    <content type="html"><![CDATA[<p>2025年618结束了，我想如果不是诸多APP开屏的广告提示，很多人都不知道各大电商已经开始了618。今年这个618是目前持续时间最长的，持续了47天。当然，未来只会更长。</p><p>根据很多电商的公关数据说，本次618的GMV都提升了不少，而且随着“跨店满减”、“凑消费券”活动的叫停，无需大量的退货，所以GMV的质量高了不少，真实度也高了不少。于是在昨天我司内部的618庆功会上，大老板宣布以后要“每月8号和18号都有一次S级大促，含预售的那种”。哦对了，说到预售，去年网络声音是预售就是罪魁祸首，但是今年还是老老实实捡起来预售了。</p><p>既然大老板这么做了“每月2次大促”的决策，肯定是他看到了我等小P没有看到的数据，比如搞大促可以让平台是赚得盆满钵满，所以多搞多赚。不过我个人是十分不认可“大促驱动电商”这个战略的，我认为这是恶性循环，只会把羊毛薅光。</p><p>现在网购也逐渐在互联网上遭到了排斥，很多人在电商促销的短视频下面评论说“不买直接立省XXX元”，而且是非常骄傲的口吻。这类发言也吸引了很多的点赞。可见“不主动参与网购”或者“网购也追求性价比”是现在人越来越多的选择。</p><p>2025年除了新闻联播里的那个平行宇宙，全国市场依旧低迷，只提增速不提通胀是扯淡。寒风吹到了每一个打工牛马，我也不例外要为了以后不确定的生活攒棺材本。最近网上有个图，比如“现在的孩子对钱没概念，30块一杯的咖啡，可以买XXX个鸡蛋，可以买XXX杯水，可以买XXX个蔬菜”。这个图都让我觉得平时消费的确是有点大手大脚，随手掏出来微信支付，嘀一下，我的数个鸡蛋就没了。</p><p>所以现在，咖啡我开始关注12.9甚至9.9。要是星巴克、TIMS、manner这些没有券我是不会买的，甚至我还跑去拉人来得到券。食堂超过餐补20的那部分，我也要嘀咕嘀咕，对现金的感觉我应该是到了一种前所未有的关注度。</p><p>为什么我现在开始主动选择“消费降级”呢？</p><p>第一，我觉得人到中年难免会对一些物质上的东西不再追求。可乐雪碧早就戒了很多年，奶油肥肉看着心里就犯腻，所以我对食欲上的追求淡了不少。至于衣服手机，整体的欲望也下降了不少，甚至有时候会觉得“这双鞋子终于穿破了，终于可以扔掉了”这个想法是一个很好的事儿，也就是说人到中年除了自身欲望的降低，整个消费注意也越来越往实用派的角度去调整。</p><p>但是众所周知，一个商品的价格有两个部分组成：使用价格和情绪价格。实用派的消费对象肯定是情绪价格较少的对象。</p><p>第二，我也开始越来越多的追求小确幸，比如在工作后来一杯美美的独享咖啡、或者去一家经常去的地方吃一顿简单的好吃的。不想跟别人分享时间，就自己去享受一个独处的美食已经成了我的一个“小舒服”。我想这个可能心态的转变是跟当下的工作节奏太快有直接的关系，不是每次都要消费一个很昂贵的东西才能让自己感受到“奖励”的感觉。除了刚才说的“节奏太快”，“阶级固化”也是一个不小的因素：在这样的社会里奋斗的人本身不一定有大的进步空间，那么自然也不会对自己有大的奖励，所以偶尔的一点点小奖励就够了。</p><p>所以我为什么也开始“消费降级”了呢？首先大环境不好，其次整体阶层固化，最后是中年人或者说“越来越多心态中年化、佛系”的人对物质的东西追求降低。这三点因素的交织导致我开始主动的去找各种各样的平替和一种新的取悦自己的方式，毕竟消费降级与生活降级不能画上一个完全的等号，而且钱是要实实在在的省下来，而不是“奶茶不喝，结果钱都扔进了股票，再次打水漂”，“把钱用在刀刃上，同时稳住当前的收入来源”才是最对自己最好的照顾。</p>]]></content>
    
    
    <summary type="html">这里只说我，不代表其他人</summary>
    
    
    
    <category term="坠乱花天" scheme="http://example.com/categories/%E5%9D%A0%E4%B9%B1%E8%8A%B1%E5%A4%A9/"/>
    
    
    <category term="消费降级" scheme="http://example.com/tags/%E6%B6%88%E8%B4%B9%E9%99%8D%E7%BA%A7/"/>
    
    <category term="电商" scheme="http://example.com/tags/%E7%94%B5%E5%95%86/"/>
    
    <category term="社会问题" scheme="http://example.com/tags/%E7%A4%BE%E4%BC%9A%E9%97%AE%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>Linux运维工程师笔试题第二十五套</title>
    <link href="http://example.com/2025/06/12/Linux%E8%BF%90%E7%BB%B4%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%AC%94%E8%AF%95%E9%A2%98%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%BA%94%E5%A5%97/"/>
    <id>http://example.com/2025/06/12/Linux%E8%BF%90%E7%BB%B4%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%AC%94%E8%AF%95%E9%A2%98%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%BA%94%E5%A5%97/</id>
    <published>2025-06-12T09:58:16.000Z</published>
    <updated>2025-11-08T00:47:01.649Z</updated>
    
    <content type="html"><![CDATA[<ol><li><p>返回数组中第K个最大的元素。比如nums &#x3D; [3,2,1,6,5,4],k &#x3D; 2,就返回5<br>【思路】首先注意一个问题，比如nums有重复值，比如[1,4,4,4,4,4]，那么第二大的元素是4还是1？肯定是4，所以完全不需要对nums进行set去重，直接sort排序，对排序后且去重的nums取[-k]就是数组中第K个最大的元素。</p></li><li><p>以数据intervals表示若干个区间的集合，其中单个区间是intervals[i] &#x3D; [start,end],请用python合并所有重叠区间，返回一个不重叠的区间数组。该数组需恰好覆盖输入数组中的所有区间。比如intervals&#x3D;[[1,3],[2,6],[8,29],[30,99]],返回[[1,6],[8,29,][30,99]]。<br>【思路】这个我开始的想法是将intervals每个数组展开到一个新的list1里，然后for循环比较，如果相邻的左边比右边大，就删除两者。最后因为索引会溢出，强制加上最后一个，最后在恢复成两两一对的数组。但是这个做法是有问题的，首先不建议对list进行remove或者pop，因为会打乱索引，搞得局面很难收拾。其次如果因为索引超出，强制写死最后一个，如果最后一个又不是整个intervals最大值就很尴尬。所以这个最好的办法就是“排序 + 合并”。</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">intervals</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> intervals:</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 按 start 排序</span></span><br><span class="line">    intervals.sort(key=<span class="keyword">lambda</span> x: x[<span class="number">0</span>])</span><br><span class="line">    merged = [intervals[<span class="number">0</span>]]  <span class="comment"># 初始化合并后的列表</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> current <span class="keyword">in</span> intervals[<span class="number">1</span>:]:</span><br><span class="line">        last = merged[-<span class="number">1</span>]</span><br><span class="line">        <span class="comment"># 如果当前区间的 start &lt;= 上一个区间的 end → 重叠，合并</span></span><br><span class="line">        <span class="keyword">if</span> current[<span class="number">0</span>] &lt;= last[<span class="number">1</span>]:</span><br><span class="line">            merged[-<span class="number">1</span>][<span class="number">1</span>] = <span class="built_in">max</span>(last[<span class="number">1</span>], current[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            merged.append(current)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> merged</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例</span></span><br><span class="line">intervals = [[<span class="number">1</span>,<span class="number">3</span>],[<span class="number">2</span>,<span class="number">6</span>],[<span class="number">8</span>,<span class="number">29</span>],[<span class="number">30</span>,<span class="number">99</span>]]</span><br><span class="line"><span class="built_in">print</span>(merge(intervals))  <span class="comment"># 输出 [[1, 6], [8, 29], [30, 99]]</span></span><br></pre></td></tr></table></figure><ol start="3"><li><p>mysql用唯一索引来去重，这个是什么原因？<br>唯一索引具备唯一性约束，即当在某个字段（或字段组合）上创建唯一索引后，MySQL 会自动检查插入或更新的数据是否违反唯一性约束。<br> a. 如果插入的数据与现有数据重复，MySQL 会抛出 Duplicate entry 错误（错误码 1062）。<br> b. 如果更新的数据导致唯一性冲突，也会报错。<br> c. 比较常见的场景就是“防止用户重复提交表单（如投票、优惠券领取）”，由数据库层强制保证数据唯一性，无需应用层校验，但是可能增加写操作的延迟。这也是一种“防呆机制”的体现。</p></li><li><p>有一个字符串它的构成是词+空格的组合，如“北京 杭州 杭州 北京”， 要求输入一个匹配模式（简单的以字符来写）， 比如 aabb, 来判断该字符串是否符合该模式， 举个例子：1. pattern &#x3D; “abba”, str&#x3D;”北京 杭州 杭州 北京” 返回 ture  2. pattern &#x3D; “aabb”, str&#x3D;”北京 杭州 杭州 北京” 返回 false  3. pattern &#x3D; “baab”, str&#x3D;”北京 杭州 杭州 北京” 返回 ture<br>【思路】因为是匹配模式，就让人联想到k-v这样的模式，那么对于python来说dict（字典）是最好不过的选择。所以可以以pattern里的每一个元素作为k，然后str对应索引的那个所谓v。如果不在dict里，就先写进去对应的k-v，然后如果k存在那么就比较v，如果v不对，就直接返回false。如果v对就返回ture。不过这里要注意一下，这里需要“双映射机制”，因为有可能出现“模式（pattern）：aba，字符串（string）：dog dog dog“这样的一对多的情况。</p></li></ol> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">def</span> <span class="title function_">is_match</span>(<span class="params">pattern, string</span>):</span><br><span class="line">    words = string.split()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(pattern) != <span class="built_in">len</span>(words):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    pattern_to_word = &#123;&#125;</span><br><span class="line">    word_to_pattern = &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> p, w <span class="keyword">in</span> <span class="built_in">zip</span>(pattern, words):</span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">in</span> pattern_to_word:</span><br><span class="line">            <span class="keyword">if</span> pattern_to_word[p] != w:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> w <span class="keyword">in</span> word_to_pattern:</span><br><span class="line">                <span class="comment"># 该词已被其他模式字符映射</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            pattern_to_word[p] = w</span><br><span class="line">            word_to_pattern[w] = p</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试用例</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># 示例1: 模式 abba</span></span><br><span class="line">    <span class="built_in">print</span>(is_match(<span class="string">&quot;abba&quot;</span>, <span class="string">&quot;北京 杭州 杭州 北京&quot;</span>))  <span class="comment"># 输出: True</span></span><br><span class="line">    <span class="comment"># 示例2: 模式 aabb</span></span><br><span class="line">    <span class="built_in">print</span>(is_match(<span class="string">&quot;aabb&quot;</span>, <span class="string">&quot;北京 杭州 杭州 北京&quot;</span>))  <span class="comment"># 输出: False</span></span><br><span class="line">    <span class="comment"># 示例3: 模式 baab</span></span><br><span class="line">    <span class="built_in">print</span>(is_match(<span class="string">&quot;baab&quot;</span>, <span class="string">&quot;北京 杭州 杭州 北京&quot;</span>))  <span class="comment"># 输出: True</span></span><br></pre></td></tr></table></figure><ol start="5"><li>域名被劫持，是什么原理？<br>域名被劫持是指攻击者通过非法手段篡改域名解析结果或控制域名所有权，将用户引导至恶意网站，窃取敏感信息（如账号密码、支付数据）或进行网络钓鱼。</li></ol><p>常见手段：<br>    a.DNS 缓存投毒（DNS Cache Poisoning）：攻击者向 DNS 服务器注入错误的 IP 地址，导致后续查询返回恶意地址。<br>    b.入侵DNS 服务器:攻击者入侵目标域名的 DNS 服务器，修改 A 记录或 CNAME 记录。<br>    c.本地 DNS 劫持:在局域网或运营商网络中，攻击者通过 ARP 欺骗或路由器漏洞篡改本地 DNS 配置。<br>    d.域名所有权劫持:攻击者通过盗用域名注册商账户或社会工程学手段，将域名转移到自己控制的账户下，从而控制域名所有权。<br>    e.CDN 劫持:攻击者通过篡改 CDN 配置或利用 CDN 服务漏洞，将域名流量劫持到恶意内容。<br>    等等</p><ol start="6"><li>DAO层是啥？<br>DAO层负责与数据库进行交互，DAO层的主要职责是将数据库操作与业务逻辑分离，提供统一的接口供上层调用。常见技术是JDBC、MyBatis等等。好处如下：<br> a.DAO 中的数据库操作可被多个业务逻辑复用。<br> b.为了业务逻辑层（Service）不直接操作数据库，而是通过 DAO 接口调用，降低模块间的依赖。<br> c.数据库变更（如更换数据库类型）只需修改 DAO 层，无需改动上层代码。</li></ol><p>如果是python的话，可以用SQLAlchemy、Django ORM模拟 DAO 层的功能。</p><ol start="7"><li>某个java应用启动很慢，有什么思路去解决？<br>主要的几个着力点就是：<br> a.应用镜像包减小：Docker 的镜像由多层只读层（Layer）组成，每个 RUN、COPY、ADD 指令会生成一个新的镜像层（含安装包和临时文件）。合并多个这种指令可以减少镜像层数，从而减小镜像体积。<br> b.清理删除无用的jar<br> c.应用分层构建<br> d.梳理所有的依赖服务，没必要的依赖就可以干掉了。我曾经见过我们的一个国际化的应用，在特定场景下依赖的服务只在某一个单元环境部署，比如应用A在新加坡部署时只依赖新加坡的服务，在杭州部署时会依赖杭州的服务，但代码中的所有consumer还是会在启动的时候全都初始化一遍，导致新加坡部署时HSF consumer还是会对杭州的服务进行初始化，但并没有服务地址可以获取到，就会默认等待3s，服务多了这个时间就会很长了。<br> e.数据库、缓存这样的中间件在启动的时候会初始化，这里也可以操作一下：比如TDDL（它是在阿里巴巴开源的druid基础上做的）做了分库分表，而且分表数量较多，那么初始化可能会耗费大量时间，就算做了异步，也会因为长尾的原因无法起到太大效果，建议从根本上降低tddl的初始化耗时。</li></ol><p>其实在启动的时候，可以关注CPU开销，如果不高，那么就是很多时间在等待（等网络，等io、等锁、等资源），这里要分别关注。按理说jvm停了，cpu就低了，jvm加载类的时候，执行cpu应该很高。</p><p>等io还是等锁可以用<code>jstack</code>来看，查看是否有线程处于<code> BLOCKED（等待锁）或 WAITING（等待 I/O）</code>状态。</p><ol start="8"><li>如果一个应用在启动的时候发现线程池满，有什么思路？<br>一般来说应用启动的时候线程池满，会同时搭配cpu飙升的情况，同时要看他的<code>code_cache</code>利用率，如果<code>code_cache</code>利用率此时利用率较低，则可以证明“这个应用在启动的过程中是没有预热的，所以启动完成后，cpu直接会到100%”。</li></ol><p><img data-src="/images/cpu%E5%90%AF%E5%8A%A8%E7%9A%84%E6%97%B6%E5%80%99%E9%AB%98.png" alt="paradin" title="启动的时候CPU一波飙升"><br><img data-src="/images/%E9%93%BE%E6%8E%A5%E6%B1%A0%E6%89%93%E6%BB%A1.png" alt="paradin" title="可以看到HSF线程池打满"><br><img data-src="/images/code_cache%E4%BD%8E.png" alt="paradin" title="但是code_cache很低，是慢慢爬上来的"></p><p>那么遇到这种情况，就需要对“代码进行预热”，以解决应用刚启动时，部分请求超时或线程池被打满问题，保证应用提供持续稳定的低响应时间和高吞吐量。</p><ol start="9"><li><p>去年你做过的最关键的事儿？</p></li><li><p>你们做了哪些事儿有效的提升了SLA？</p></li><li><p>你们为了应付流量上涨都有什么策略？<br>a. 根据历史的监控情况，做好单链路压测和全链路压测，来做好容器的规划，一半预留30%。<br>b. 服务尽量做到无状态，将状态数据（session等）外存到redis，这样随时都可以扩容。<br>c. 配置k8s 的HPA触发自动扩容。<br>d. 启动的时候预加载缓存&#x2F;缩容的时候延迟下线，避免请求丢失。<br>e. 做好限流，sentinel做好服务层接口限流。<br>f. 通知、日志这些能做异步化的做异步化。<br>g. 排队机制。<br>h. 紧急预案，比如临时取消一些非核心的逻辑。</p></li><li><p>场景题：我有一个应用，是产出短链接的，每一次产出都不一样，可以被用户分享到各个社交平台，然后用户点击访问。读qps大约3000，写qps大约1000，每一个短链接有效期30天。  从以上几个信息，你能判断出我这个应用需要做哪些稳定性的建设么？</p></li></ol>]]></content>
    
    
    <summary type="html">回答出来问题不是目的，要回答的让面试官眼前一亮，关注到他平时没有关注的东西才是牛逼的</summary>
    
    
    
    <category term="大牛之路" scheme="http://example.com/categories/%E5%A4%A7%E7%89%9B%E4%B9%8B%E8%B7%AF/"/>
    
    
    <category term="python" scheme="http://example.com/tags/python/"/>
    
    <category term="面试" scheme="http://example.com/tags/%E9%9D%A2%E8%AF%95/"/>
    
    <category term="算法题" scheme="http://example.com/tags/%E7%AE%97%E6%B3%95%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>Linux运维工程师笔试题第二十四套</title>
    <link href="http://example.com/2025/06/09/Linux%E8%BF%90%E7%BB%B4%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%AC%94%E8%AF%95%E9%A2%98%E7%AC%AC%E4%BA%8C%E5%8D%81%E5%9B%9B%E5%A5%97/"/>
    <id>http://example.com/2025/06/09/Linux%E8%BF%90%E7%BB%B4%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%AC%94%E8%AF%95%E9%A2%98%E7%AC%AC%E4%BA%8C%E5%8D%81%E5%9B%9B%E5%A5%97/</id>
    <published>2025-06-09T04:05:09.000Z</published>
    <updated>2025-11-08T00:47:01.934Z</updated>
    
    <content type="html"><![CDATA[<ol><li>在一个整形数组中， 1 ≤ a[i] ≤ n (n &#x3D; 数组长度), 有些数出现两次，有些数出现一次。需要找到所有出现两次的数字。算法复杂度越小越好。比如[4, 3, 2, 7, 8, 2, 3, 1]，能返回[2,3]<br>【思路】首先这个数组长度是n，那么索引就是0～n-1。要取两个一样的数，因为他们的值是一样的，但是索引又不一样，怎么能够搭配“值跟索引”的关系呢？就借用值一样的前提，那么他们这个“数对应的索引”的值是同一个值，那么这个值可以取负来标记。当第二次取的时候，发现是负数则加入到一个新的列表里，最后这个列表的内容就是结果。</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">find_duplicates</span>(<span class="params">nums</span>):</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> nums:</span><br><span class="line">        idx = <span class="built_in">abs</span>(x) - <span class="number">1</span><span class="comment"># 这里为啥是减1？因为长度是n，索引就是0～n-1</span></span><br><span class="line">        <span class="keyword">if</span> nums[idx] &lt; <span class="number">0</span>:</span><br><span class="line">            res.append(<span class="built_in">abs</span>(x))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            nums[idx] = -<span class="number">1</span> * nums[idx]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">nums = [<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(find_duplicates(nums))  <span class="comment"># 输出: [2, 3]</span></span><br></pre></td></tr></table></figure><p>如果你想玩暴力，那么就是每一个值都要比较，原列表元素少还好办，如果元素很多的话，需要比较n的平方次，计算量非常大，如果不考虑时间复杂度可以这么搞。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">findDuplicates</span>(<span class="params">nums</span>):</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nums)):</span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nums)):</span><br><span class="line">            <span class="keyword">if</span> nums[j] == nums[i]:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> count == <span class="number">2</span> <span class="keyword">and</span> nums[i] <span class="keyword">not</span> <span class="keyword">in</span> res:</span><br><span class="line">            res.append(nums[i])</span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><ol start="2"><li>数组中，所有数字都出现两次，只有一个数字出现一次，找到他。<br>【思路】要找出数组中唯一出现一次的数字（其余所有数字均出现两次），最高效的方法是使用<code>异或运算（^）</code>。</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">singleNumber</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        result = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> nums:</span><br><span class="line">            result ^= num</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例调用</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    sol = Solution()</span><br><span class="line">    <span class="built_in">print</span>(sol.singleNumber([<span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>]))  <span class="comment"># 输出: 4</span></span><br><span class="line">    <span class="built_in">print</span>(sol.singleNumber([<span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>]))        <span class="comment"># 输出: 1</span></span><br><span class="line">    <span class="built_in">print</span>(sol.singleNumber([<span class="number">1</span>]))              <span class="comment"># 输出: 1（单个元素）</span></span><br></pre></td></tr></table></figure><ol start="3"><li>一维数组查找指定数字。无序数组怎么查？有序数组呢？<br>无需数组好像只能暴力轮询，有序数组可以用“二分查找”法：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">binary_search</span>(<span class="params">nums, target</span>):</span><br><span class="line">    left, right = <span class="number">0</span>, <span class="built_in">len</span>(nums) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> left &lt;= right:</span><br><span class="line">        mid = (left + right) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> nums[mid] == target:</span><br><span class="line">            <span class="keyword">return</span> mid</span><br><span class="line">        <span class="keyword">elif</span> nums[mid] &lt; target:</span><br><span class="line">            left = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            right = mid - <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span></span><br></pre></td></tr></table></figure><ol start="4"><li>对字符串数组进行排序，将所有变位词组合在一起。变位词是指字母集合相同，但排列不同的字符串。<br>示例:<br>输入: [“eat”, “tea”, “tan”, “ate”, “nat”, “bat”],<br>输出:<br>[<br>[“ate”,”eat”,”tea”],<br>[“nat”,”tan”],<br>[“bat”]<br>]</li></ol><p>【思路】字符串相同但是排列不同，那么意思就是排列相同的话他们就是一个字符串。如何排列相同呢？那么就用到sort()，所以我们可以利用排列后是同一个字符串作为一个key，而具体的不同排列作为value。所以我们可以上来建立一个dict，格式是{同一个字符串：[]}，然后一点一点把后面的[]填满。那么这个格式的dict可以用defaultdict来创建。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">group_anagrams</span>(<span class="params">strs</span>):</span><br><span class="line">    groups = defaultdict(<span class="built_in">list</span>)</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> strs:</span><br><span class="line">        key = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">sorted</span>(s))。<span class="comment"># 这里进行对字符串进行按照字母排序</span></span><br><span class="line">        groups[key].append(s)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(groups.values())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例测试</span></span><br><span class="line">input_strs = [<span class="string">&quot;eat&quot;</span>, <span class="string">&quot;tea&quot;</span>, <span class="string">&quot;tan&quot;</span>, <span class="string">&quot;ate&quot;</span>, <span class="string">&quot;nat&quot;</span>, <span class="string">&quot;bat&quot;</span>]</span><br><span class="line"><span class="built_in">print</span>(group_anagrams(input_strs))</span><br></pre></td></tr></table></figure><ol start="5"><li><p>唠唠mysql的having语句<br>HAVING 是 SQL 中用于过滤分组后结果的子句，通常与 GROUP BY 一起使用，可以在 HAVING 中使用聚合函数的别名。<br>与 WHERE 的区别：<br> a. WHERE 在分组前过滤原始数据。<br> b. HAVING 在分组后过滤聚合结果。</p></li><li><p>不要用其他内置工具，纯手动计算阶乘来计算 1! + 2! + 3! + … + 20! 的和<br>【思路】如果用内置工具，就用math.factorial，直接拿到阶乘。但是题目里要求不要用，就可以先写一个函数，函数的能力就是阶乘。传入的是20，然后设定一个a&#x3D;1，然后range(1,21)，a轮询自己乘自己得到阶乘。然后再加上一个for循环求和即可。</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">jiecheng</span>(<span class="params">n:<span class="built_in">int</span></span>):</span><br><span class="line">    a = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n+<span class="number">1</span>):</span><br><span class="line">        a = a*i   <span class="comment"># 直接用上一个结果*最新</span></span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">total = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">21</span>):</span><br><span class="line">    total = total + jiecheng(x)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(total)</span><br></pre></td></tr></table></figure><ol start="7"><li>利用递归方法求5!</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">jiecheng</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> n * jiecheng(n-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ ==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(jiecheng(<span class="number">5</span>))</span><br></pre></td></tr></table></figure><ol start="8"><li>给定一个字符串，将其进行压缩，例如abbcccdddd，压缩后为a1b2c3d4</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">total = <span class="string">&#x27;&#x27;</span></span><br><span class="line">str1 = <span class="string">&#x27;abbcccdddd&#x27;</span></span><br><span class="line">str2 = <span class="built_in">sorted</span>(<span class="built_in">set</span>(str1))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> str2:</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(i,<span class="built_in">str</span>(str1.count(i)))</span><br><span class="line">    total = total + <span class="built_in">str</span>(str1.count(i))+i</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(total)</span><br></pre></td></tr></table></figure><ol start="9"><li><p>大表join小表，有什么加速手段？<br>将小表作为驱动表（Build Side）,逐条扫描小表，然后在大表中查找匹配数据。因为小表行数少，减少循环次数。<br>在大表的 Join 字段上建立索引，这种适合“小表驱动 + 大表的 Join 字段无索引”的场景。<br>在 Join 前对大表进行过滤，如果大表按 Join 字段分区，利用分区信息跳过无关分区，这样是为了减少参与 Join 的数据量。</p></li><li><p>给定一个字符串s，找出最长的不含重复元素的“最长子串”。比如s&#x3D;’abcabcbb’，最长的子串就是‘abc’。<br>【思路】因为是不重复元素，那么就用set()。这个要用到滑动块的思路，这个滑动块最开始长度为0，然后右移一格，发现里面的元素不在这个set()里，就继续右移一格，发现元素在set()里，就左移，直到左右指针相遇代表已经遍历了整个字符串s。然后取这个set()里最多的元素个数就行了。</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">longest_unique_substring</span>(<span class="params">s: <span class="built_in">str</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    sw = <span class="built_in">set</span>()  <span class="comment"># 这个是一个滑动窗口</span></span><br><span class="line">    l = res = <span class="number">0</span> <span class="comment"># 左指针 和 result = 0</span></span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">        <span class="keyword">while</span> s[r] <span class="keyword">in</span> sw:  <span class="comment"># 这里用while是因为有可能是abb这样连续2个b的情况，持续移除左边界字符</span></span><br><span class="line">            sw.remove(s[l])</span><br><span class="line">            l = l+<span class="number">1</span> <span class="comment">#去除最左边的元素，然后左移一格</span></span><br><span class="line"></span><br><span class="line">        sw.add(s[r])</span><br><span class="line">        res = <span class="built_in">max</span>(res,r-l+<span class="number">1</span>) <span class="comment"># 这里加1的原因是l r都是索引，是从0开始的，而数量是从1开始，所以要+1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    s = <span class="string">&#x27;abcabcbb&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(longest_unique_substring(s))</span><br></pre></td></tr></table></figure><ol start="11"><li>什么是回表？<br>假设有一个表<code>users</code>，结构如下：<br>CREATE TABLE users (<br>id INT PRIMARY KEY,         – 聚簇索引（主键）<br>name VARCHAR(100),          – 普通字段<br>age INT,<br>INDEX idx_name (name)       – 非聚簇索引<br>);</li></ol><p><code>SELECT * FROM users WHERE name = &#39;Alice&#39;; </code>这个语句使用 idx_name 索引：查找 name &#x3D; ‘Alice’ 的记录，得到对应的 主键 id。而回表就是：“再根据主键 id，到聚簇索引中查找完整的数据行（如 age 字段）”这个过程。回表每次回表都需要额外的 I&#x2F;O 操作。</p><ol start="12"><li><p>为什么”产生大量生命周期长&#x2F;无法回收的对象，会导致GC频繁”?</p></li><li><p>那为什么GC会让CPU飙升？</p></li><li><p>dig命令和nslookup命令有用过么？</p></li></ol>]]></content>
    
    
    <summary type="html">在Java中，未使用BufferedInputStream读取文件导致调用方sys过高，本质是频繁的系统调用引起的性能瓶颈</summary>
    
    
    
    <category term="大牛之路" scheme="http://example.com/categories/%E5%A4%A7%E7%89%9B%E4%B9%8B%E8%B7%AF/"/>
    
    
    <category term="python" scheme="http://example.com/tags/python/"/>
    
    <category term="面试" scheme="http://example.com/tags/%E9%9D%A2%E8%AF%95/"/>
    
    <category term="算法题" scheme="http://example.com/tags/%E7%AE%97%E6%B3%95%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>当谈论面试的时候是在谈论什么</title>
    <link href="http://example.com/2025/05/28/%E5%BD%93%E8%B0%88%E8%AE%BA%E9%9D%A2%E8%AF%95%E7%9A%84%E6%97%B6%E5%80%99%E6%98%AF%E5%9C%A8%E8%B0%88%E8%AE%BA%E4%BB%80%E4%B9%88/"/>
    <id>http://example.com/2025/05/28/%E5%BD%93%E8%B0%88%E8%AE%BA%E9%9D%A2%E8%AF%95%E7%9A%84%E6%97%B6%E5%80%99%E6%98%AF%E5%9C%A8%E8%B0%88%E8%AE%BA%E4%BB%80%E4%B9%88/</id>
    <published>2025-05-28T12:56:52.000Z</published>
    <updated>2025-11-08T00:48:02.239Z</updated>
    
    <content type="html"><![CDATA[<p>面试是一个很好的交流、学习、成长途径，不管对方是强是弱，都能从中学到一些东西。</p><p>翻了下笔记，最近两年我面试了大约 160 多个人，包括校招、社招、外包，当然，这不仅仅是我团队的招聘面试，还包括帮其他团队做的面试，而且其中的大部分都是在帮人面试。可能有一些人不喜欢帮人面试，而我却乐在其中，今天就来分享下我是如何去享受每一场面试并从中学习、成长的。</p><p>这篇文章的重点是阐述在面试过程中我是如何从候选人身上学习并成长的，但不可避免的会穿插一些如何去做一场面试的内容。</p><p><img data-src="/images/%E9%9D%A2%E8%AF%953.png" alt="paradin" title="这个图简单写了一下整个面试和挖掘人的流程"></p><h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><p>每次面试之前我都会做一些简单准备，目的是为了提升面试的效率、降低沟通的成本。一般来说，我会通过以下几点来做准备：<br>● 简历：主要看技术栈、项目经验、公司业务；<br>● GitHub：如果候选人有 GitHub 帐号，会提前去浏览下其在 GitHub 上的情况；<br>● 公司背景：对于不熟悉的公司会先去网上大致了解下相关资料；<br>● 应聘部门：如果是帮人面试还会去大概了解下应聘部门的业务情况和考察的侧重点；<br>● 疑惑：针对简历中不熟悉的技术栈或者知识点会事先去了解些相关的内容资料；<br>● 备题：我没有一套通用的面试题，只有一个大致的脉路，每次会根据上述的一些点并结合目前我在工作中遇到的问题和困境去大致理出一个要考察的要点。<br>很多人会忽略这个过程，但对我来说，这是一个很好的“看世界”的方式，视野决定格局，世界那么大，虽然不能亲身出去看看，但还能通过面试来见识。</p><h2 id="面试"><a href="#面试" class="headerlink" title="面试"></a>面试</h2><p>交流的过程是学习的重要过程，前期的准备工作越充足我们越知道我们要在这次面试中要得到什么。这个过程需要以空杯心态来应对，好的多交流，差的尽可能的挖出你想要的点再结束，不然就白面了。当然，如果实在实在不堪，也无需多言。</p><p>这一过程我主要从技术、业务、团队三方面来阐述：</p><h3 id="技术"><a href="#技术" class="headerlink" title="技术"></a>技术</h3><p>作为技术面试官，技术面是最重要的一环，可以借助这个环节与候选人做很多技术方面的探讨。说实话，现在平时写的代码量少了，很多技术有在学习但其实是缺乏很深入的实践，通过面试可以帮助我更深刻的去了解一门技术。</p><p>通常我会从三个方面进行技术面试：技术深度、技术广度和项目经历：</p><p>**技术深度：**结合面试前的准备，我会针对某个技术领域去跟候选人做深入的探讨，让他给我讲具体的原理、细节以及最佳实践，从而帮助我增强相关领域的理解，我也会提出疑问、挑战，看候选人的应对如何。当然，一段时间内可能我会对所有人都考察同样的知识点、同样的面试题，看看不同的人对某项技术的学习和思考过程。<br>**技术广度：**除了在某方面技术上的深度外，还会去看候选人在技术广度上的涉猎。特别是当我在简历中看到某个当前很火或者很独特又或者正在兴起的技术时，面试中我就会问及这些技术点，看他们对某项技术的思考、实践、对比等，去了解这门技术到底是做什么的、适用在哪些场景？然后对比我们的场景是否适合，未来是否要在这项技术上去布局和落地。<br>**项目经历：**从项目经历可以看出一个人的逻辑思维能力和实战能力，特别是一些复杂的项目或者跟我们场景相似的项目我会重点去考察。结合前期的准备，我会把我们项目中遇到的一些问题同样抛出来，看候选人是否曾经遇到过又是如何去解决的，在这个过程中可以学习他们的思考过程和解法，从而帮助我们的项目做得更好。</p><h3 id="业务"><a href="#业务" class="headerlink" title="业务"></a>业务</h3><p>业务跟项目是完全不一样的东西，业务认知和思考也是很重要的一个考察点，通过这方面的考察可以学到很多非技术上的点，这方面我主要会问及两个点：业务场景和技术突破。<br>**业务场景：**技术人都有个产品梦吧，想把一个产品做到极致，所以面试时特别喜欢跟候选人聊他们的产品、他们的业务模式、商业模式，了解下候选人对产品的诞生、定位、发展的认知，看看别人的产品是如何一步步走向强大又或者是一步步走向衰亡，回过头来再看看自己的业务怎么去增长和突破。<br>**技术突破：**技术与业务相结合也是我们一直在说并且鲜有人做的非常好的地方，所以通常情况下我也会向候选人请教这方面的做法，看看他们所做的技术是如何从业务出发、给业务带来了哪些改变以及如何去评估两者之间产生的结果。</p><h3 id="团队"><a href="#团队" class="headerlink" title="团队"></a>团队</h3><p>人毕竟不是个体，一定有团队配合，在大公司其实团队方面的问题也更为突出，所以我也会问在面试过程中去候选人交流一些团队相关的事情，主要是协作、管理和招聘：<br>**协作：**如何与自己团队、其他团队协作是我们经常遇到的问题，也是怎么做都有很大提升空间的事情，而每个人在这方面的处理方式也不同，可以学习下每个公司不同的团队文化和做事方式，特别是小团队的运作方式，很多是值得我们学习和效仿的。<br>**管理：**如果候选人已经在带团队，那也会向其请教带团队的经验，如何定位自己的职责、建设团队的核心竞争力、带领团队突破，又是如何保证自己的成长。<br>**招聘：**如何能够招到更多的人可能是现在很多团队很多人面临的问题，而一部分候选人本身其实也正是团队招聘的主力或者负责人，我会向其学习招聘方面的技巧和经验，从而帮助自己找到更好的招聘途径或者方法。事实也证明很多人的招聘经验蛮不错的，非常值得学习和效仿。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>面试完成不代表结束，面试中的问题、经验还需要做下总结和梳理，这个过程可长可短、可急可缓、可以是思考也可以是书面的，我一般会从三方面来整理和总结这场面试：<br>**候选人的缺点：**候选人身上存在哪些问题或者哪些我不喜欢的地方，我自己是否也有，应该怎么改正？<br>**待验证的点：**面试中是否有候选人没讲透的或者存疑的技术点，需要去查找资料或者找人求证；<br>**好的经验：**面试过程中看到的候选人做的好的点以及值得学习的点重点去梳理并考虑应用在工作中。</p><p>面试是一面镜子，能够让我发现自己的不足。面试也是一个学习平台，让我不断的获取新的技能。总之，面试值得一做再做！<br><img data-src="/images/%E9%9D%A2%E8%AF%95.webp" alt="paradin" title="凡事都要多反思，多思考"></p>]]></content>
    
    
    <summary type="html">不是我的原创，但是需要了解出题人的套路才能更好的有针对性得分</summary>
    
    
    
    <category term="大牛之路" scheme="http://example.com/categories/%E5%A4%A7%E7%89%9B%E4%B9%8B%E8%B7%AF/"/>
    
    
    <category term="面试" scheme="http://example.com/tags/%E9%9D%A2%E8%AF%95/"/>
    
    <category term="思考" scheme="http://example.com/tags/%E6%80%9D%E8%80%83/"/>
    
    <category term="心得" scheme="http://example.com/tags/%E5%BF%83%E5%BE%97/"/>
    
  </entry>
  
  <entry>
    <title>现役亚洲足球明星排名</title>
    <link href="http://example.com/2025/05/25/%E2%80%9C%E7%8E%B0%E5%BD%B9%E4%BA%9A%E6%B4%B2%E8%B6%B3%E7%90%83%E6%98%8E%E6%98%9F%E5%89%8D%E5%8D%81%E6%8E%92%E5%90%8D%E2%80%9D/"/>
    <id>http://example.com/2025/05/25/%E2%80%9C%E7%8E%B0%E5%BD%B9%E4%BA%9A%E6%B4%B2%E8%B6%B3%E7%90%83%E6%98%8E%E6%98%9F%E5%89%8D%E5%8D%81%E6%8E%92%E5%90%8D%E2%80%9D/</id>
    <published>2025-05-25T06:02:23.000Z</published>
    <updated>2025-11-11T02:36:23.444Z</updated>
    
    <content type="html"><![CDATA[<p>本文提到的球员都是现役的，他们的生涯其实很多都还没有盖棺定论，说不定日后被大球队看中捞去拿下欧冠，那么这个排名就会有大的变化。我这个排名是依据“当前的荣誉再加上一点点对未来的贷款”，仅仅是个人意见。</p><p><img data-src="/images/%E4%BA%9A%E6%B4%B2%E7%90%83%E5%91%98%E8%BA%AB%E4%BB%B7.webp" alt="paradin" title="2024年年末的亚洲球员身价top10"></p><p>其实伊藤杨辉、铃木彩艳、佐野海舟等人的实力也非常的强，但是他们不是本赛季受伤就是职业生涯还刚刚开始，积累的荣誉和经典时刻还不多。至于克瓦拉茨赫利亚，他的祖国古鲁吉亚跟俄罗斯一样，国土虽然大部分在亚洲，但是他本人是参加欧洲杯的，所以不算亚洲球员。</p><h2 id="第十一名-胡桑诺夫"><a href="#第十一名-胡桑诺夫" class="headerlink" title="第十一名 胡桑诺夫"></a>第十一名 胡桑诺夫</h2><p>他3500万转会曼城后，2月份成了曼城队内的最佳球员。但是后来不知道啥原因又上不了场，不过后防球员在瓜手下往往第一年其实都过的比较挣扎，比如罗德里等人都是第二年才踢出来感觉的。所以我可以接受再给他一年的时间，毕竟他才21岁。但是他成为曼城后防大腿的可能性我觉得不会太高，格瓦迪奥尔目前看才是曼城的防线大腿。他若能稳定跟着曼城走，不掉链子的话，个人天赋也算是兑现了。希望胡桑诺夫不要被曼城早早优化，对得起我个人对他的期望。</p><h2 id="第十名-铃木彩艳"><a href="#第十名-铃木彩艳" class="headerlink" title="第十名 铃木彩艳"></a>第十名 铃木彩艳</h2><p>虽然他是混血儿，但是他是日本国籍，所以也就是第一个能在意甲踢首发门将的东亚人。虽然中国网友笑话他是“日本奥纳纳”，但是这位日本奥纳纳的状态最近越来越好，身价也到达了1400万欧元。他也在逼平尤文图斯的比赛里拿下了全场最佳球员，整个赛季下来零封7场，扑救100次，扑救成功率65.4%，都是不错的表现。虽然帕尔马不是强队，在本赛季最后一轮3-2击败了亚特兰大才完成了保级，这只是铃木彩艳第一个意甲赛季，下个赛季他肯定会越来越好。<br><img data-src="/images/%E9%93%83%E6%9C%A8%E5%BD%A9%E8%89%B3.gif" alt="paradin" title="对阵罗马时候神奇两连扑"></p><h2 id="第九名-黄喜灿"><a href="#第九名-黄喜灿" class="headerlink" title="第九名  黄喜灿"></a>第九名  黄喜灿</h2><p>黄喜灿的新合同是狼队顶薪的水平，可见他在队内是大腿级别的待遇了。他今年英超拿下13个进球3个助攻，累计为狼队出场超过100次，进球数在狼队历史上已经进top10了。他速度非常快，当年在红牛队的时候跟哈兰德和南野拓实大杀四方。后来到了狼队，以前跟内托搭档后来换成了和库尼亚配合，都是狼队撕开对手防线的利器。他是一个勤奋的球员，第一次射门不中后马上上抢再发起二次进攻是他进球的一个主要手段。他是韩国球员一步一个脚印旅欧的典范，19岁就出国踢球，球风也非常的欧洲范儿。当年亚运会夺冠几乎是他一路得分，让全队免除兵役。当然，他的缺点也很明显，踢球的时候手上动作比较大，而且我觉得他好像对中国人不算太友好。</p><h2 id="第八名-富安健洋"><a href="#第八名-富安健洋" class="headerlink" title="第八名 富安健洋"></a>第八名 富安健洋</h2><p>tomi如果是健康的话，那么他的能力肯定不止这个位置，他能踢三后卫也能踢四后卫，场均抢断和高空拦截都是队内前列。可惜他不争气的身体偏偏在合同年膝盖大伤，伤后功力还存有多少真的让人难以预测，辜负了阿尔特塔对他的期待。健康的他绝对可以镇守住阿森纳的一条边，毕竟他在有限的出场时间里表现过高光时刻，联赛里单防住C罗，在世界杯也跟萨内比过赛跑，实力绝对没个说。但是富安健洋论个人能力肯定是不如金玟哉的，富安健洋也在意甲踢过，他没拿到意甲最佳后卫，他也没进入最后的金球奖30人大名单。富安健洋还有一点很可惜，就是他一直没有亚洲杯，团队荣誉除了一个社区盾杯就没啥东西了，这一点对他来说太伤了。最后希望tomi能够早日满血复活。<br><img data-src="/images/%E5%AF%8C%E5%AE%89%E5%81%A5%E6%B4%8B.gif" alt="paradin" title="他是第9位在英超进球的日本球员"></p><h2 id="第七名-塔雷米"><a href="#第七名-塔雷米" class="headerlink" title="第七名 塔雷米"></a>第七名 塔雷米</h2><p>塔雷米是一个大器晚成的球员，他在波尔图是大腿的表现，进球如麻，2022年世界杯面对英格兰虽然输了2-6，但是那两个球都是他进的，在2019年亚洲杯，他成了中国队后防的噩梦。31岁高龄的他第一次登陆五大联赛，也是国际米兰第一位伊朗球员，他是这个赛季国米唯一一个所有赛事都参与进球的球员，这个记录看上去很好，但是其实一共只参与9个进球，可以说除了欧冠半决赛之外都并不让人满意。塔雷米工资还不低，被国米球迷吐槽是“除了造点球之外，这人没啥用”。但是毕竟国米现在在备战欧冠决赛，要是真的拿下了对面巴黎，塔雷米就是伊朗第一个拿到欧冠的球员，只是以后国米可能就不再会轻易买葡超来的人了。</p><h2 id="第六名-李刚仁"><a href="#第六名-李刚仁" class="headerlink" title="第六名 李刚仁"></a>第六名 李刚仁</h2><p>李刚仁之前在法国超级杯决赛里拿过全场最佳球员，他在本赛季虽然新闻不多，但是其实他的出场时间比上个赛季还多了300多分钟，sofascore的评分到达了7.34的高分。他是恩里克战术体系很重要的一环，能打边路和中路的他是典型的西班牙风格，喜欢前场自由人踢无球，相比较射门，他更喜欢传威胁球，是一个弱版的维蒂尼亚。他的能力足够在五大联赛中游队伍做前场核心，据说阿森纳和曼联都对他很有兴趣，我个人觉得他真要走的话，去曼联的出场机会会更稳定，更有利于他的职业生涯发展，但是我还是觉得恩里克不会轻易放走他。现在孙哥逐渐走到了职业生涯的末期，韩国队需要他来扛大旗，目前看他扛起来还挺费劲的，但是结合他的能力和年轻的客观优势，这里排名第六。</p><h2 id="第五名-镰田大地"><a href="#第五名-镰田大地" class="headerlink" title="第五名 镰田大地"></a>第五名 镰田大地</h2><p>记得水晶宫拿下足总杯之后，范志毅在社媒说了一句“我们是冠军”，但是毕竟他那时候的水晶宫只是一个英甲和英冠的球队，说这话被苛责的球迷批评是在蹭流量。这句话应该放在退役以后的镰田大地来说，他是第一个拿到足总杯的日本球员。kamada是进攻中非常重要的一环，虽然他本赛季在英超没有进球助攻（在杯赛2进球3助攻），但是在这个榜单里他在五大联赛里进球仅次于孙兴慜，累计44个进球33个助攻，十足的数据怪。他速度不快但是配合意识和前插意识很强，而且骚的是他的任意球和角球主罚质量很高。镰田大地之前在法兰克福拿下了欧联杯（其中两回合5:4击败了哈维的巴萨，镰田大地他们很好的限制了特劳雷和登贝莱）和德国杯（德国杯他没进大名单），也有单场帽子戏法和任意球直接破门的高光表现，技术弱点就是单干能力不行，简单说他就是一个弱版的京多安。他跟久保建英不太兼容，森保一没办法只能牺牲他。镰田本人也一直有一个跟大球队打欧冠的心，但是自身实力只能在中游球队打出来，所以也算是一个小小的无奈。<br><img data-src="/images/%E9%95%B0%E7%94%B0%E5%A4%A7%E5%9C%B0.webp" alt="paradin" title="散步仙人，冠军赢家"></p><h2 id="第四名-远藤航"><a href="#第四名-远藤航" class="headerlink" title="第四名 远藤航"></a>第四名 远藤航</h2><p>endo的实力和武士精神有目共睹，他在克洛普的重用下拼下了联赛杯冠军，赛后发布会上克洛普对他各种赞美之词，利物浦球迷也唱歌“切尔西有enzo,我们有endo”。而在斯洛特手下他不再是主力，出场时间锐减，但是要注意，他的时间其实是随着赛程而慢慢增多的，他自己接受采访也说“斯洛特就是需要我锁分的”，所以说今年的英超冠军绝对有他的一份功劳（这个联赛冠军是他人生的第一个联赛冠军）。这个夏天随着维尔茨的加盟，endo可能会离开利物浦，给利物浦回收大约500万左右的资金。不过以他的口碑和能力，留在英超问题不大，但是去阿森纳的话，阿森纳虽然走了若日尼奥但是基本搞定了苏维门迪。去曼联接班卡塞米罗呢，曼联基本不怎么跟利物浦做生意。所以这俩队伍就基本去不了了。切尔西也不需要他。endo已经32岁了，估计再踢2～3年就会离开五大联赛了，只要这几年endo还能在英超稳住一定的出场时间，那么他的历史地位肯定不会低。而且他本人也是我的偶像，低调勤奋但是又很聪明，用赛场上的表现让那些说他“只会犯规延缓对面进攻和卡位造犯规”的黑子和瞎子们闭嘴。</p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=113899563123697&bvid=BV12QfUYBEdE&cid=28108001014&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"></iframe><h2 id="第三名-金玟哉"><a href="#第三名-金玟哉" class="headerlink" title="第三名 金玟哉"></a>第三名 金玟哉</h2><p>为啥我把金玟哉放在endo前面，因为他在那不勒斯那一年的表现真的很高光，入选了赛季最佳阵容不说，还在同年金球奖评选排名22，是30人大名单里和迪亚斯唯二的后卫，他也是第一个拿到意甲冠军的韩国人，狠狠打了杜威等中国足球工作者的脸。金玟哉在拜仁这两年并不完美，不少拜仁球迷把去年被皇马淘汰的锅扣在他身上。金玟哉他自己说远程兵役对他影响很大，也有自身水平下滑的问题，不过其实最大的原因就是拜仁对他的过度使用上。再加上中国媒体很喜欢挖苦韩国人，凡是说韩国不好的新闻优先安排上热搜，所以大家对他的贡献都是低估的，有跟风黑的嫌疑。但是说来说去他兜里毕竟有两个主力的联赛冠军，而且高光的时候很高光，所以排名还是要压endo一点点的。</p><h2 id="第二名-三笘薰"><a href="#第二名-三笘薰" class="headerlink" title="第二名 三笘薰"></a>第二名 三笘薰</h2><p>三球王这个赛季一共11个球，其中英超10个球，打破了自己的最好记录也创造了日本球员在英超联赛的新纪录。他登陆英超3年了，24+16的数据已经比黄喜灿要好了（黄喜灿是24+7，黄喜灿比他多半年。风格相似的曼城多库是11+17，但是时间比他少一半）。他的第一脚触球、盘带和突破依旧非常犀利，也是本赛季全英超加速跑次数最多的球员。但是这个赛季三球王已经被对手有针对性的防守了，暴露了射门天赋比较差的缺点。而且三球王年纪也不小了，身体不算耐操，能维持这个水平到31～32岁已经算很厉害。我当年是希望他能来巴萨的，现在看已经是不可能，传闻他要去拜仁（拜仁打算凑齐一套东亚全明星），也有说曼联要买他来替代要走人的加纳乔。无论去哪，三球王都值得去欧冠看看。考虑到他是进攻球员，天然比防守球员有点优势，而且将来也有几率去了大球会，所以微微领先金玟哉一丢丢。<br><img data-src="/images/%E4%B8%89%E7%90%83%E7%8E%8B%E6%9C%80%E4%BD%B3%E8%BF%9B%E7%90%83.gif" alt="paradin" title="这个进球成了2425赛季最佳进球的候选"></p><h2 id="第一名-久保建英"><a href="#第一名-久保建英" class="headerlink" title="第一名 久保建英"></a>第一名 久保建英</h2><p>相比较三球王是边路爆点，久保建英则是进攻核心，而且他也能过人，昨天在莫德里奇的告别战里他全场7次过人成功，本场比赛最多。而且久保建英目前还不满23，所以算上年轻的贷款，他的排名比三球王高。但是属于他的时间我个人觉得不多了，他需要尽快有一个质的飞跃，把数据稳定在15+5。去年就传闻他要去利物浦，但是只是谣传而已。他跟李刚仁一样，身体不搞大但是也不怕对抗。把自己尽快提升成一个S级别的球星，对日本队是一个巨大的帮助。</p><h2 id="第零名-孙兴慜"><a href="#第零名-孙兴慜" class="headerlink" title="第零名 孙兴慜"></a>第零名 孙兴慜</h2><p>毫无疑问，sonny是毫无争议的亚洲一哥，就算拉上那些退役的人一起来比，他的成绩都完全不虚任何人，所以他是第零名！细想一下，将来如果有人要超越孙哥，那么他至少要是以球队主力的身份赢下“欧冠冠军or联赛冠军”，且自己有一个mvp或者金靴，且金球奖排名要进前10，这个成绩妥妥的就是国际巨星的成绩单了。孙哥今年饱受伤病，本赛季只进了11球是他个人在热刺生涯的最低值，但是热刺久旱逢甘露拿下了欧联杯，而且下赛季还有可能去争夺一个欧洲超级杯，希望孙哥好好恢复，届时再冲一下这个冠军。<br><img data-src="/images/%E5%AD%99%E5%85%B4%E6%85%9C.webp" alt="paradin" title="以孙哥对热刺的贡献，立个碑不过分吧"></p><p>文章写完后发现，本文出现的球员可以正好打一个3-4-3阵容：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">三笘薰   塔雷米   孙兴慜</span><br><span class="line">李刚仁  镰田大地  久保建英</span><br><span class="line">           远藤航</span><br><span class="line">胡桑诺夫   金玟哉    富安健洋</span><br><span class="line">     铃木彩艳</span><br><span class="line"></span><br><span class="line">替补坐着 黄喜灿</span><br></pre></td></tr></table></figure><p>这个阵容，我觉得在英超保级，问题应该不大。</p>]]></content>
    
    
    <summary type="html">这里只说现役的选手，退役的大神们就先不考虑了。</summary>
    
    
    
    <category term="坠乱花天" scheme="http://example.com/categories/%E5%9D%A0%E4%B9%B1%E8%8A%B1%E5%A4%A9/"/>
    
    
    <category term="足球" scheme="http://example.com/tags/%E8%B6%B3%E7%90%83/"/>
    
    <category term="亚洲" scheme="http://example.com/tags/%E4%BA%9A%E6%B4%B2/"/>
    
  </entry>
  
  <entry>
    <title>记录一次排查cpu飙高的问题</title>
    <link href="http://example.com/2025/05/23/%E2%80%9C%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E6%8E%92%E6%9F%A5cpu%E9%A3%99%E9%AB%98%E7%9A%84%E9%97%AE%E9%A2%98%E2%80%9D/"/>
    <id>http://example.com/2025/05/23/%E2%80%9C%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E6%8E%92%E6%9F%A5cpu%E9%A3%99%E9%AB%98%E7%9A%84%E9%97%AE%E9%A2%98%E2%80%9D/</id>
    <published>2025-05-23T03:41:53.000Z</published>
    <updated>2025-11-08T00:47:23.787Z</updated>
    
    <content type="html"><![CDATA[<h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><p>今天发现一个集群里的某一台机器CPU涨了很多。如图：<br><img data-src="/images/cpu%E4%B8%8A%E6%B6%A8.png" alt="paradin" title="流量没变化，sys和user都上涨了很多"></p><p>爬到容器里，<code>top -Hp 对应的PID</code>看了一下，里面是很多个线程都CPU很高：<br><img data-src="/images/cpu%E4%B8%8A%E6%B6%A82.png" alt="paradin" title="好几个线程"></p><p>跑到宿主机里一看，整个宿主机cpu和load都有上涨：<br><img data-src="/images/cpu%E4%B8%8A%E6%B6%A84.png" alt="paradin" title="时间也吻合，所以可见是容器带高了整体宿主机"></p><p>从宿主机的监控看，这个容器的cpi也上涨：<br><img data-src="/images/cpu%E4%B8%8A%E6%B6%A85.png" alt="paradin" title="CPI 是衡量CPU性能的指标，表示执行一条指令所需的平均时钟周期数"></p><p>同时发现这个容器的younggc频率没变化，但是gc耗时比以前明显多了很多：<br><img data-src="/images/cpu%E4%B8%8A%E6%B6%A83.png" alt="paradin" title="gc耗时上涨的时刻跟cpu上涨时刻吻合"></p><p>由于频率没变化，但是耗时上涨，我怀疑可能是内存出了问题，导致现在每一次gc的时候更加消耗cpu了，于是<code>sudo dmesg -T |grep -i &quot;Hardware Error&quot;</code>，果然容器在对应的时刻附近有内存硬件的报警：<br><img data-src="/images/cpu%E4%B8%8A%E6%B6%A86.png" alt="paradin" title="看到大量的mce告警"></p><p>于是将这个容器进行了置换，置换后的ip再看CPU和load都恢复了正常。</p><h2 id="心得"><a href="#心得" class="headerlink" title="心得"></a>心得</h2><p>其实一个集群里某一个机器出了问题，是比较难查的。因为那么多机器没问题，唯独你有问题，那么就要想哪些地方是这个机器跟其他同集群里机器不同。可以从以下几个方面排查解决：</p><ol><li>这个机器遇到了一个很特殊的参数，比如我们曾经见过一个很奇葩的商品，里面好几万的sku和子品。唯独流量走到了这个机器上，当这个应用的逻辑处理的时候，暴露了逻辑上问题，所以要结合时间去业务的日志里查。</li><li>容器的底层出了问题，看看网络重传率，对比宿主机其他的容器系统情况，使用dmesg定位，然后需要宿主机的同学进一步配合排查。如果容器进行置换之后，问题解决更可以说明是宿主机的问题。</li><li>可以跟其他的机器进行对比：对比线程使用cpu的细节，对比内存里都存了啥，对比流量是不是跟其他容器的流量有不同，但是这种有点大海捞针，比较费时间。</li></ol>]]></content>
    
    
    <summary type="html">print(f&#39;{i+1}/{a}&#39;, end=&quot;&#92;r &quot;) 打印当前进度（如 1/10000），end=&quot;&#92;r &quot; 表示每次打印后将光标移回行首，实现“进度条”覆盖刷新效果</summary>
    
    
    
    <category term="工作与技术" scheme="http://example.com/categories/%E5%B7%A5%E4%BD%9C%E4%B8%8E%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="CPU" scheme="http://example.com/tags/CPU/"/>
    
    <category term="问题定位" scheme="http://example.com/tags/%E9%97%AE%E9%A2%98%E5%AE%9A%E4%BD%8D/"/>
    
  </entry>
  
  <entry>
    <title>巴萨的24～25赛季末总结</title>
    <link href="http://example.com/2025/05/17/%E5%B7%B4%E8%90%A8%E7%9A%8424%EF%BD%9E25%E8%B5%9B%E5%AD%A3%E6%9C%AB%E6%80%BB%E7%BB%93/"/>
    <id>http://example.com/2025/05/17/%E5%B7%B4%E8%90%A8%E7%9A%8424%EF%BD%9E25%E8%B5%9B%E5%AD%A3%E6%9C%AB%E6%80%BB%E7%BB%93/</id>
    <published>2025-05-17T05:17:56.000Z</published>
    <updated>2025-11-08T00:48:01.467Z</updated>
    
    <content type="html"><![CDATA[<p>这个赛季对于巴萨来说很有里程碑的意义，是巴萨在后梅西时代的重大胜利，巴萨已经庆祝三次游行一次了，而且据说数十万球迷上街庆祝。国内三冠王外加欧冠四强，四杀死敌皇马，尤其西超杯、国王杯都是直接踩着皇马拿到冠军，还有什么比这个成绩更爽的么？<br><img data-src="/images/%E5%B7%B4%E8%90%A8%E5%A4%BA%E5%86%A0.jpg" alt="paradin" title="这是一个几乎完美的赛季！"></p><h2 id="先说比赛"><a href="#先说比赛" class="headerlink" title="先说比赛"></a>先说比赛</h2><p>今年巴萨在新帅弗里克的带领下，巴萨全队在防守端高举“造越位”大旗，在进攻端火力全开（5名球员进球上双，西甲总共进了102个球，整个赛季进了170+个球）。尤其是赛季初连斩拜仁、皇马，甚至还有7球大胜瓦伦西亚、巴拉多利德的表现。虽然赛季中途一度六轮只拿2分排名掉到第三，但是2025年后一波高盘再次在西甲联赛逆转胜。在将高效反击、落位压迫以及原有的传控体系融合之后，这支巴萨变得势不可挡。</p><p>弗里克还坚持使用拉玛西亚的球员，根据CIES的统计，巴萨本赛季西甲中本队青训球员的出场时间占比达到49.3%，在欧洲五大联赛范围内，该项数据排名第二，仅次于毕包。</p><p>上个赛季的巴萨角球进球是8个，是自17～18赛季巴尔韦德开始执教巴萨以来的最多，这个赛季基本持平。本赛季巴萨各个赛事逆转场有9次之多，这个是一个重大的进步，很多先丢球的比赛，巴萨都最后拿下了，这在上赛季是不可想象的。而且这个赛季巴萨更强的是客场作战能力，巴萨在西甲客场目前拿下了45分，是全西甲最高，比皇马高出7分，比马竞高出15分，甚至比自家主场拿的分数都多。</p><p>根据OptaJose的统计，巴塞罗那本赛季在各项赛事已经有23次禁区外完成进球，这是2018&#x2F;19赛季（同为23次）以来单赛季最高的数据。其中亚马尔一个人就贡献了7脚，是全欧洲最多。让我不得不感慨，当年巴萨花了一亿多买来库蒂尼奥就为了一脚穿云箭，没想到穿云箭在这里。</p><h2 id="众人的救赎之路"><a href="#众人的救赎之路" class="headerlink" title="众人的救赎之路"></a>众人的救赎之路</h2><p>今年最大的签约无疑就是主教练弗里克的降临。弗里克来之前也是一个失意人，他在德国队的表现饱受诟病，被“有能教练”森保一打下课，一度没工作。巧的是跟当年同样沦落到埃弗顿的安切洛蒂一样，被大球会再次给了机会，证明了自己。尤其是这个夏天巴萨除了奥尔默的加入之外就没有什么大的投入，反而还走了不少人（罗克、京多安等等）的条件下，弗里克也做到了“看菜下饭”，把一个上赛季进攻便秘的队伍打造成了进攻之师。而且顶住了赛季中“希望之星吉乌走人”、“奥尔默注册风波”、“京多安离开”、“伊尼戈违规出场问题”、“队医突然离世”、“阿劳霍可能要转会尤文”，“回归1:1又没戏了”等等场外的干扰，让更衣室专注于赛场上。可见他对更衣室球员的掌控能力非常的强。</p><p>除了掌控能力，弗里克对巴萨这些球员的了解比哈维要高一个层次。弗里克延续哈维后期对拉菲尼亚的使用方式，让他继续在左路也可以满场无球跑。让佩德里后撤发挥了他的能力，更重要的是他鼓励孔德大胆压上，跟亚马尔去打配合。这三个人可以说是弗里克改造最成功的三个人。</p><p>不得不说，拉波尔塔在弗里克身上赌对了，去年拉波尔塔对待哈维的反复无常已经把自己放在火上烤了，但是今年巴萨战绩傲人，他自己在下一次的主席连任中肯定有个最大的选票，球迷其实就是这么现实。</p><p>那么我们来看一下在弗里克带队之下今年的球员排名：</p><h3 id="S级"><a href="#S级" class="headerlink" title="S级"></a>S级</h3><ol><li><p>亚马尔：对于这位天才少年的赞美，全世界说的很多了，已经不需要我多说了，而且球队媒体对他保护的很好，即使在西甲100多天没进球也没人喷。如果再能克服浪费机会（wasteful Goals-xG  5.0排名第4）这个小缺点，那就更加完美了。这个夏天第一任务就是跟亚马尔续约。<br><img data-src="/images/%E4%BA%9A%E9%A9%AC%E5%B0%94.png" alt="paradin" title="亚马尔今年统治了他所在的右路"></p></li><li><p>拉菲尼亚：这位在哈维手下显得“有心杀贼、无力回天”的男人，在弗里克的带领下打出了金球前三的水平。拉菲尼亚这个赛季的无球踢法表现的非常好，而且还经常后撤回防，每场能在后场提供1.8次抢断可见他是“防守进攻一肩挑”，唯一美中不足就是阿根廷巴西的世界杯预选赛结束后有一点低潮期。巴萨夺冠后马上官宣拉菲尼亚续约到2028年，届时他就32岁了，可以说把生涯最好的4～5年给了巴萨，到时候再去沙特或者美国养老也不失一个不错的选择。<br><img data-src="/images/%E6%8B%89%E8%8F%B2%E5%B0%BC%E4%BA%9A.jpeg" alt="paradin" title="这个图里拉菲尼亚是59，但是我查了一下应该是56，实际还是低于萨拉赫的"></p></li><li><p>佩德里：德国欧洲杯被黄狗克罗斯一脚干废了的佩驴，今年交出了最铁人的出场数据。位置后撤的他同时还能兼顾进攻，成为了一个B2B的中场球员。他和德容在“造越位”的防守体系下需要提供非常大的地面拦截能力。他今年也很好的完成了这一点，是西甲夺回球权最多的球员，254次。<br><img data-src="/images/%E4%BD%A9%E5%BE%B7%E9%87%8C%E5%9C%BA%E5%9D%87%E5%BE%97%E5%88%86.jpeg" alt="paradin" title="今年佩德里金球奖不进前10真的没天理了"></p></li><li><p>孔德：这个赛季孔德几乎就是右边卫的top3，相比上赛季的迷茫，这个赛季他能进球能助攻，跟内马尔的右路配合简直就是巴萨的开瓶器。尤其是国王杯决赛那惊天一脚，直接把巴萨送上冠军宝座。</p></li><li><p>伊尼戈-马丁内斯：没想到，人到中年的伊尼戈这个赛季迎来大爆发，他和库巴西的搭档成为了巴萨这个赛季造越位战术的中流砥柱。不过巴萨后期的丢球开始有上涨趋势，下赛季势必要升级防守战术，不然肯定要出事。</p></li></ol><h3 id="A级"><a href="#A级" class="headerlink" title="A级"></a>A级</h3><ol><li><p>莱万：赛季初我还说“莱万这个赛季能进25个球就算成功”，结果他这个赛季进了几乎40个球，大大超出了我的期望。虽然莱万这个赛季也丢了很多必进球，但是有他在的前场就是更流畅一些，莱万来了4年了，拿了5个国内冠军的同时也进了101个球，在巴萨只有18个人做到过进球破百的成绩，所以莱万说自己一句巴萨名宿也完全不过分了。下赛季，莱万请再维持一下30个进球，再冲一次欧冠冠军吧！<br><img data-src="/images/%E8%8E%B1%E4%B8%87.jpeg" alt="paradin" title="莱万的表现总体来说符合他的工资"></p></li><li><p>德容：德容这个赛季在后半段是越踢越好，逐渐得到了弗里克的重用，而且队长的职责力也越来越明显。今年德容已经是“巴萨队内荷兰人出场次数的第三位”了，下赛季肯定超越科曼上升至第二。他跟佩德里是目前全世界最好的中场二人组，完全不逊于巴黎的“维蒂尼亚-若昂内维斯”。</p></li><li><p>艾里克加西亚：他在哈维的带领下赢得了西甲冠军，在赫罗纳度过了一个神奇的赛季，现在又在弗里克的带领下赢得了另一个西甲冠军，而且他的作用更加突出。在赛季最关键的阶段，他参加了巴萨最近23场比赛中的22场。而且他就是弗里克手下的罗贝托，可以打后场三个位置，尤其是右后卫简直就是主力水准。</p></li><li><p>奥尔默：奥尔默是2024年夏天巴萨唯一的大手笔，花了5500万。但是要说这笔钱是不是非常的划算，我倒是觉得还可以，有数据表示，奥尔默的进球让巴萨在联赛里多拿了8分。这么一看，这个钱很值。而且奥尔默本赛季为巴萨出场1945分钟，拿下12球6个助攻，这些数据都是他近5年的最高了。但是奥尔默感觉踢满90分钟是一个很难的事儿，他这个夏天肯定是要狂练体能。</p></li><li><p>费兰-托雷斯：费兰托雷斯可以说是今年也达到了个人最高光的表现，屡屡替补进球，首发的时候也能短暂顶得住。尤其是国王杯决赛打入扳平的一球更是价值连城。他这个赛季一共进了17个球，是西班牙球员最多。</p></li><li><p>费尔明-洛佩斯：小明在2024年夏天是冠军赢家，拿到了欧洲杯也拿到奥运会男足金牌，这个赛季又收获了国内三冠王。弗里克拿他当奥尔默的替补，他的射门欲望不比奥尔默差，脚头也够硬，但是他下个赛季多半还是竞争不过奥尔默，夏天也有可能转会。<br><img data-src="/images/%E5%B0%8F%E6%98%8E.jpeg" alt="paradin" title="费尔明在进攻端完全碾压了贝林厄姆"></p></li><li><p>巴尔德：巴尔德这个赛季比上个赛季强出太多，西超杯决赛甚至抽了库尔图瓦一个，在西甲又收获4次助攻，场均预期助攻比去年几乎多了一倍，可见哈维是不喜欢边后卫太压上的，但是弗里克却鼓励他压上。在进攻端进步的同时，场均丢失球权比去年少了2次，巴尔德如果不受伤，国米那一关应该是能过的去的。他在新的赛季里需要继续对防“倒三角”这一点下功夫。</p></li></ol><h3 id="B级"><a href="#B级" class="headerlink" title="B级"></a>B级</h3><ol><li><p>库巴西：今年奶龙依旧是防线大腿，表现比曼联的约罗等人强，表现总体来说稳定。有部分比赛有红牌和失误的表现，当然今年也有各种各样的小伤，脸还被破了相。他跟伊尼戈是西甲里向前传球次数最多的两个中卫，双出球中卫在西甲是没问题的，但是在欧冠还是有点慌，毕竟他俩的身高其实都不算高（都不满足185cm）。这个赛季虽然学费交了不少，估计下赛季会表现的更好。</p></li><li><p>佩尼亚：今年的佩尼亚其实比上个赛季的“射正亡”真的好多了，而且对阵皇马还有一场零封的表现，其中扑出了姆巴佩的单刀球。可惜后来由于迟到事件被彻底拿下首发，估计他夏天会离开巴萨吧。</p></li><li><p>什琴斯尼：毫无疑问，他是2025年最成功复出奖的获得者。其实我还是觉得3C很多时候的出击太莽撞了，当然这是巴萨的高位后防线逼的。原本好好的一个门线型门将搞的天天面对单刀也很无奈。虽然他出场胜率很高，但是他的扑救数据并不特别优秀，而且在对阵国米的比赛里被对面的索默压了一头。所以给他暂时放到B级。</p></li><li><p>卡塞多：跑是真能跑，对抗也是真的差，打不了单后腰。但是他下赛季肯定还是弗里克重点培养对象，只要跟得上全队的节奏，就是一个合格的首发。</p></li><li><p>伯纳尔：其实他是很亮眼的，可以早早受伤了。下赛季满血回归，肯定是重点培养的可塑之才。</p></li><li><p>克里斯滕森：把藤森放到这里，主要是他出场时间太少。藤森据说这个夏天也会离开回到英超，不过我倒是觉得藤森防守比阿劳霍更稳当，身材也高大（188cm），对造越位的巴萨来说，抢第一点头球的能力是很重要的。我个人马后炮来说，对阵国米最后几分钟应该上藤森的。</p></li></ol><h3 id="C级"><a href="#C级" class="headerlink" title="C级"></a>C级</h3><ol><li><p>加维：很遗憾，加维，我是很爱你的。但是不得不承认你现在是巴萨中场里最尴尬的一环，他没有什么防守上的天赋，更多依赖斗志，生涯四个赛季已经吃了42张黄牌。目前看他在弗里克心里的顺位是比较低的，但是主教练还是给了不少机会，他也尽力在表现自己。留在巴萨打轮换补位对球队是好事，但对他自身来说不是什么好事了。</p></li><li><p>保-维克多：出场时间太少，给人的印象还是夏季美国赛的时候进过皇马一球。</p></li><li><p>法蒂：没啥好说的，弗里克基本不会用他，不知道是不是管理层的要求，反正他这个夏天基本要走人了。据说要租借去法甲摩纳哥。</p></li><li><p>阿劳霍：总体来说，阿劳霍在这个赛季的亮眼表现不多，而且对阵国米的时候还被球迷网暴。留下来肯定要接受一些心态上的转变，如果走的话也能留下一笔不低的转会费。但是随着塔签约拜仁，感觉他其实走不了。</p></li><li><p>特尔施特根：大根这里要多说一点，我觉得他有可能这个夏天会离开，因为根据数据来看，大根面对单刀的扑救率是巴萨三个门将里的最差。远低于最近的绯闻目标大马丁。尤其是欧冠赛场，巴萨这么开放的踢法，而且“有一个好扑救就能顶一个进球”的低容错率，大根有时候的状态和心态的确让人捏了一把汗。我觉得他要是真的离开也未必不是一个好的选择。可怜大根了，被老婆绿还要度过一个不太舒服的休赛期…</p></li></ol><p>全队几个重要球员分析完毕，那么再回头看S级的分布：前场两人，后场两人，中场一人还是一个铁人，球队成绩不好就见鬼了。</p><h2 id="营收-夏季转会"><a href="#营收-夏季转会" class="headerlink" title="营收&amp;夏季转会"></a>营收&amp;夏季转会</h2><p>这个赛季巴萨在转会市场的投入是盈利3000万的，在冬窗除了跟阿劳霍、哈维、佩德里续约就没有动作。夏季转会盈利610万，冬窗曼城买了尼克-冈萨雷斯，巴萨因此多拿到了2400万欧元。再加上今年巴萨本赛季营收大概率冲击10亿，7月份又确认会来日本和韩国亚洲行。从财政角度来说或许可以过一个“肥年”，但是说白了其实也肥不到哪里去，毕竟还有那么多的历史包袱。</p><p>夏天要走的人，估计就是：佩尼亚、法蒂和托雷。至于保-维克托、克里斯滕森等人，我倒是觉得都可以再留一下，尤其是藤森他也可以打后腰。至于费兰、大根、小明，除非报价特别好，他三个也是可以离开的。</p><p>前面说了弗里克和拉波尔塔都是可以松一口气的人，但是偏偏球队体育总监德科的压力却没有小，他去年搞来不中用的罗克已经算是被很多球迷质疑了，其他的很多出色球员并不是他搞来的，说白了就是这个三冠王其实跟他没啥大关系。如果他这个夏天不能有效处理掉冗员并且有效补强，或者跟亚马尔的续约没有弄好，他估计会被球迷喷到关闭评论。目前巴萨还有这几个人的转会分成条款：<br>1. 在葡萄牙体育的特林康，50%转会分成<br>2. 在拉斯马尔巴斯的马尔莫，有50%转会分成<br>3. 在西汉姆的托迪博，有20%转会分成<br>4. 在塞尔塔的明戈萨，有50%转会分成<br>5. 红牛租借给塞尔塔的莫里巴，有10%转会分成<br>6. PSV的韦斯特，还有一点分成<br>7. 罗克还有10%的转会分成</p><p>说实话这几个人里能拿到钱的可能性其实都不大，基本无法指望他们能卖很多钱了。</p><p>至于说要来的人，目前传闻比较猛的迪亚斯，据说转会费要8500万，这简直太扯了，迪亚斯的年龄跟拉菲尼亚同岁，还要8500万那么贵，傻子才会买。</p><p>这个赛季最需要补其实是亚马尔的替补，亚马尔在赛季中途受伤的时候，那个位置是拉菲尼亚代打的，效果并不好。所以依旧需要一个能突破的人来顶上（至于内马尔、拉什福德啥的就算了吧，只是球迷的一厢情愿），这里我倒是觉得李刚仁如果便宜的话可以看看。</p><p>其次的问题就是莱万接班人的问题，莱万估计下个赛季还是会状态下滑，能维持住30个进球就不错了。那么莱万这部分的工作是交给谁呢？还是一个很大的问题。有人说是哲凯立什或者伊萨克，但是他俩也都不便宜，而且估计也有主力位置的诉求。</p><p>至于最近传也很火的大马丁，我个人觉得他是很适合这支巴萨的，面对单刀的扑救能力的确是五大联赛top级别。说实话，纵观巴萨的历史，除了梅西之外的阿根廷人很少有在巴萨成功的。而且大马丁年纪大工资高，考虑到这些事情总觉得这个交易不太现实。</p><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>巴萨下赛季一定要解决的就是防守问题，从4月23日1:0战胜马洛卡之后的所有比赛，目前看只有2:0战胜西班牙人和最后一轮3:0毕尔巴鄂是零封。这种防线肯定是不满足高水平的欧冠要求。全年巴萨的0封场次是21场，不足50%，单场丢球超过3个的比赛却有7个。要去争夺欧冠，尤其是很多年轻球员在今年的大胜利之后，进取心有所不同的前提下，势必要在防守下更加下足功夫，不然赢取欧冠就是痴人说梦。</p><p>再其次就是任意球得分能力的问题，这个赛季巴萨一共在西甲27脚任意球就进了一个…上个赛季21脚任意球还进了俩呢，缺少这种任意球高手在打破僵局的时刻也是一个伤。</p><p>至于伤病控制问题，其实弗里克团队已经做的很专业了，明年如果运气好一点，在最后冲刺阶段关键球员没有伤病，那就太好了。</p><p>2024年的夏天是西班牙足球的绽放时刻，他们不仅拿下了2024年的欧洲杯冠军还拿下了奥运会男足金牌。而无论是西班牙的胜利还是到今天的三冠王，其实都是巴萨足球的春天。死对头皇马把主教练换成了阿隆索，说实话相比较安切洛蒂，我其实没那么怕阿隆索，我觉得明年巴萨还是会在成绩上压皇马一头的。Visca Barça, Visca Catalunya！</p><p><img data-src="/images/%E6%8B%89%E7%8E%9B%E8%A5%BF%E4%BA%9A.webp" alt="paradin" title="拉玛西亚，生生不息，明年继续出发！"></p><h2 id="相关新闻"><a href="#相关新闻" class="headerlink" title="相关新闻"></a>相关新闻</h2><p><a href="https://baijiahao.baidu.com/s?id=1832236390227214084&wfr=spider&for=pc">https://baijiahao.baidu.com/s?id=1832236390227214084&amp;wfr=spider&amp;for=pc</a><br><a href="https://m.hupu.com/bbs/630711476.html">https://m.hupu.com/bbs/630711476.html</a></p>]]></content>
    
    
    <summary type="html">我去年在日本新宿的kamo店买了一件亚马尔本赛季的125周年球员版球衣，现在就静等它涨价了。</summary>
    
    
    
    <category term="坠乱花天" scheme="http://example.com/categories/%E5%9D%A0%E4%B9%B1%E8%8A%B1%E5%A4%A9/"/>
    
    
    <category term="国际足坛" scheme="http://example.com/tags/%E5%9B%BD%E9%99%85%E8%B6%B3%E5%9D%9B/"/>
    
    <category term="巴塞罗那" scheme="http://example.com/tags/%E5%B7%B4%E5%A1%9E%E7%BD%97%E9%82%A3/"/>
    
  </entry>
  
  <entry>
    <title>全链路压测中遇到的一个奇葩问题</title>
    <link href="http://example.com/2025/05/15/%E5%85%A8%E9%93%BE%E8%B7%AF%E5%8E%8B%E6%B5%8B%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%B8%AA%E5%A5%87%E8%91%A9%E9%97%AE%E9%A2%98/"/>
    <id>http://example.com/2025/05/15/%E5%85%A8%E9%93%BE%E8%B7%AF%E5%8E%8B%E6%B5%8B%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%B8%AA%E5%A5%87%E8%91%A9%E9%97%AE%E9%A2%98/</id>
    <published>2025-05-15T02:18:02.000Z</published>
    <updated>2025-11-08T00:47:45.749Z</updated>
    
    <content type="html"><![CDATA[<h2 id="事情回溯"><a href="#事情回溯" class="headerlink" title="事情回溯"></a>事情回溯</h2><p>这几年618大促越来越早了，5月14日集团决定要加一场全链路压测用于验证16日的618付尾款的链路稳定性。</p><p>于是我们白天就准备好了晚上压测用到的数据预热任务：预热任务是12点启动，数据的缓存过期时间是43200秒，即12个小时，也就是晚上12点数据过期，足够覆盖压测的时间段了。<br><img data-src="/images/%E7%BC%93%E5%AD%98%E8%BF%87%E6%9C%9F3.png" alt="paradin" title="缓存时间12小时"></p><p>我们的预热逻辑是这样的：从odps离线表里拿到key，然后预热接口会请求这些key，如果没有的话，就会去数据库里查，然后再put到缓存里，逻辑很简单。</p><p>然后整个预热过程非常顺利，命中率和成功率都满足要求：<br><img data-src="/images/%E7%BC%93%E5%AD%98%E8%BF%87%E6%9C%9F2.png" alt="paradin" title="预热效果达到了预期"></p><p>晚上压测分为几个阶段：20点压“现货+尾款”阶段，系统表现正常符合预期。然后21点休息半小时，21点半开始脉冲流量压“纯现货交易”阶段，而这一波流量刚起来，上游就在群里反馈由于我们系统挂了导致他们出现了大量错误：<br><img data-src="/images/%E7%BC%93%E5%AD%98%E8%BF%87%E6%9C%9F.png" alt="paradin" title="上游看就是unsh有大量的timeout，center的少一点"><br><img data-src="/images/%E7%BC%93%E5%AD%98%E8%BF%87%E6%9C%9F7.png" alt="paradin" title="从我们的角度看就是大量数据不存在"><br><img data-src="/images/%E7%BC%93%E5%AD%98%E8%BF%87%E6%9C%9F8.png" alt="paradin" title="数据库出现了大量的读"></p><p>然后我们一看错误细节，发现是缓存有大量的写操作，即数据库被打爆了。换言之就是缓存数据过期了，但是不应该呀，上面说过了，我们的数据应该是晚上12点过期的，为什么21点半就过期了？<br><img data-src="/images/%E7%BC%93%E5%AD%98%E8%BF%87%E6%9C%9F9.png" alt="paradin" title="因为21点32分的压测脉冲压垮的上游，所以中途停掉了压测，21点55又重新打了一波流量"></p><p>再针对一个key，看了一下具体的put时间和失效时间：<br><img data-src="/images/%E7%BC%93%E5%AD%98%E8%BF%87%E6%9C%9F1.png" alt="paradin" title="发现果然是新插入的"></p><p>先去tair里，发现一天内并没有逐出的现象，而且tair的容量也没有满：<br><img data-src="/images/%E7%BC%93%E5%AD%98%E8%BF%87%E6%9C%9F4.png" alt="paradin" title="2天缓存都没有任何的逐出"></p><p>然后预热的离线表内容也没有任何的变化，前几天也用的同样的预热数据压测却没有任何的问题，可见不是因为预热数据发生了变更，导致有数据漏掉了：<br><img data-src="/images/%E7%BC%93%E5%AD%98%E8%BF%87%E6%9C%9F6.png" alt="paradin" title="数据条数是一样的"></p><p>后来把这个缓存的写入时间拉长发现了一点端倪：<br><img data-src="/images/%E7%BC%93%E5%AD%98%E8%BF%87%E6%9C%9F5.png" alt="paradin" title="早上9点多的时候发现有数据写入，unsh单元写的少，center单元写的多"></p><p>后来问了一下负责压测的同学，他早上9点上班之后，会用压测流量走一下“渲染这个应用的接口”拉一把最新的偏移好的营销压测数据，防止这个营销数据过期导致压测的时候出现下单阻断的情况，这个是常规的操作。而我们这个应用是在渲染这个应用的下游，所以早上他跑接口的时候也会请求到我们这个应用。</p><p>结论就是：早上压测同学试跑的时候，压测流量击穿到DB的请求实际没有影子数据，会通过空保护对象进行缓存，这类对象无法通过主动预热任务写进缓存，依赖JIT压测流量自然预热。早上09:10到09:50有压测试跑流量，这时会将这些流量的空保护对象写进缓存，压测数据过期时间统一设置为12h +（1min内随机时间），因此晚上21点到21点30期间这些空保护对象会集中失效，从而导致21:31分脉冲时缓存击穿到DB，进而引起DB抖动。</p><p>事后action：<br>1. 这个过程太强依赖负责压测同学在构造url时打的流量和压测前的jit流量，如果将来他们技术进步了，不再有这个步骤的话，那么我们这个流量就无法被预热到缓存里，所以还需要把预热的主动权掌握在自己手里。<br>2. 将缓存失效时间打散，不要一批全部失效，打散时间从原来的1分钟延长到1个小时内随机失效。<br>3. 同时减少tair调用量，降低空查询比例，提升主动预热任务的有效性。</p><h2 id="空保护"><a href="#空保护" class="headerlink" title="空保护"></a>空保护</h2><p>啥是空保护呢？是一种通过缓存“空值”来防止缓存穿透的策略。它的核心目标是避免因查询不存在的数据而导致数据库或后端服务被频繁访问，从而保护系统稳定性。</p><p>例如用户恶意构造不存在的ID，导致每次请求都会穿透到数据库，可能引发数据库压力激增甚至崩溃。举个例子：用户频繁查询 ID&#x3D;99999999 的数据（该ID在数据库中不存在）→ 缓存中没有该ID → 请求穿透到数据库 → 数据库返回空 → 重复触发。这样就会产生一些到服务端不必要的调用以及产生了很多不必要的日志，直到数据库or服务端嗝屁。</p><p>所以就通过缓存“空值”（如 null 或特定标记），将不存在的数据结果缓存一段时间，避免重复请求穿透到数据库。</p><p>实现流程：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>查询缓存：</span><br><span class="line">a.如果缓存中有数据（命中），直接返回。</span><br><span class="line">b.如果缓存中没有数据（未命中），继续查询数据库。</span><br><span class="line"><span class="number">2.</span>查询数据库：</span><br><span class="line">a.如果数据库中存在数据，将数据写入缓存并返回。</span><br><span class="line">b.如果数据库中不存在数据，将空值（null）写入缓存，并设置较短的TTL（过期时间）。</span><br><span class="line"><span class="number">3.</span>后续请求：</span><br><span class="line">a.相同请求会直接从缓存中获取空值，不再访问数据库。</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">在大促正式开卖前8个小时，业务让技术紧急订正数据，原本20点透出的国补优惠券在19点就透出，搭配上届时的弹窗通知，实现让用户提前凑单的业务效果。然而这个商战有没有实际效果，事后看了看领取数据和下单量就知道了。</summary>
    
    
    
    <category term="工作与技术" scheme="http://example.com/categories/%E5%B7%A5%E4%BD%9C%E4%B8%8E%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="缓存" scheme="http://example.com/tags/%E7%BC%93%E5%AD%98/"/>
    
    <category term="空保护" scheme="http://example.com/tags/%E7%A9%BA%E4%BF%9D%E6%8A%A4/"/>
    
    <category term="全链路压测" scheme="http://example.com/tags/%E5%85%A8%E9%93%BE%E8%B7%AF%E5%8E%8B%E6%B5%8B/"/>
    
  </entry>
  
  <entry>
    <title>唠唠同城容灾</title>
    <link href="http://example.com/2025/04/08/%E5%94%A0%E5%94%A0%E5%AE%B9%E7%81%BE/"/>
    <id>http://example.com/2025/04/08/%E5%94%A0%E5%94%A0%E5%AE%B9%E7%81%BE/</id>
    <published>2025-04-08T12:02:03.000Z</published>
    <updated>2025-11-08T00:47:51.101Z</updated>
    
    <content type="html"><![CDATA[<p>作为一个SRE，其实要面对的故障原因主要就是这么几个：</p><ol><li>基础设施</li><li>生产系统</li><li>操作人</li><li>操作流程</li></ol><p>既然基础设施肯定会出问题（挖断光缆、火灾等等），那么容灾这个课题是每一个SRE必须要研究的事情。不过相比较火灾这种影响面是一栋楼的，洪水+大风这种影响一片楼的天灾更吓人。</p><p>此时SRE就要跟基础的同学一起制定演练规则、演练机制、容灾架构和具体的演练方案，通过定期的演练可以验收如下事情：<br>● 容灾能力检验：检验集团业务线核心业务的容灾能力（恢复能力、恢复时长）；<br>● 容灾预案有效性检验：检查核心业务机房级故障容灾预案有效性；<br>● 容灾风险透视：预先透视容灾风险，降低风险转化为线上故障的的机率；<br>● 容灾应急能力提升：通过演练，提升灾难场景下业务团队的协作能力；</p><p>这里本文先唠唠“同城容灾”。</p><p>首先同城要有多个机房，而且每个机房都要投入生产，而不是一个机房工作另一个机房闲着，这要做的目的第一是对成本友好，第二是确认两个机房都是能正常接入业务流量的。</p><p>其次业务应该优先接入同城容灾，同时接入层aserver、数据库（三节点）、Tair（缓存主备）、中间件早已标配同城容灾能力，因此对于业务而言接入同城容灾成本是非常低的，基本上只要应用容器在双机房部署，并且将HSF服务规则和VIPServer对称调用策略都开启同机房优先即可(非必选，可通过CDR执行CS拉黑预案；能接受更长RTO可等待中间件健康检测感知断网自动收敛)。</p><p>那么啥样的业务优先接入呢？肯定是核心链路，比如我司是负责电商的，那么“核心链路”指用户完成“选购，下单”这条动线上所必需的界面和功能，至少包括“首页、搜索、店铺、详情、购物车、下单页、支付、订单列表与详情”等。当出现区域或AZ类型的故障时，必须保证这些功能的迅速恢复和可用，同时不断提升其他增值功能的保障能力，逐步对齐核心链路。</p><p><img data-src="/images/%E5%AE%B9%E7%81%BE1.png" alt="paradin" title="日常态的架构"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">入口流量按照<span class="number">1</span>:<span class="number">1</span>均衡分布到两个机房的接入层，接入层通过VIPServer获取upstream列表，并按照同机房转发以保证入口流量尽量在机房内封闭。</span><br><span class="line">应用间HSF服务调用通过HSF服务接口的同机房优先策略保证RPC流量尽量在机房内封闭。</span><br><span class="line">Notify和MetaQ：消息双机房随机收发。</span><br><span class="line">MDB定制版：应用读写本机房的集群，两个机房的集群会双向同步删除操作。这里解释一下为啥要这样，因为降低延迟，提升性能。电商里很多的秒杀、实时风控的场景，这些都是对延迟敏感的业务，所以RT不能太高。同时每个机房也可以根据负载来独立扩容，比如增加只读实例。为啥要双向同步删除操作，是为了保障数据的一致性，用户在一个机房删除数据后，若另一机房未同步删除就会有数据不一致（重复订单）的问题。</span><br><span class="line">MDB标准版：应用跨机房读写。</span><br><span class="line">LDB：主备模式，其中一个机房的应用需要跨机房读写。</span><br><span class="line">数据库：主备模式，<span class="number">3</span>节点分布在张北 NA61 NA62 NA63 <span class="number">3</span>机房，<span class="number">3</span>节点强一致数据同步，由于同城机房网络时延&lt;1ms，因此对业务几乎无感知。</span><br></pre></td></tr></table></figure><p>当进入容灾态的时候，就是这样了：<br><img data-src="/images/%E5%AE%B9%E7%81%BE2.png" alt="paradin" title="接入层（例如aserver）、应用层都在演练范围、Tair部分加白，xdb数据库不在演练范围。"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">入口流量由GOC统一切到非故障机房的接入层，接入层通过VIPServer获取upstream列表，并按照同机房转发以保证入口流量尽量在机房内封闭。</span><br><span class="line">应用间HSF服务调用通过HSF服务接口的同机房优先策略保证RPC流量尽量在机房内封闭。如未设置同机房优先则会出现跨机房的HSF调用超时，需要等待CS感知心跳并自动收敛或者通过CDR主动拉黑断网容器IP。</span><br><span class="line">Notify和MetaQ：故障时变成同机房收发消息；如有消费者仅在故障机房部署，此时消息会堆积，但不会丢。</span><br><span class="line">MDB定制版：应用读写本机房的集群，两个机房的集群会双向同步删除操作。故障时无需切换，网络恢复后故障机房的缓存数据会被清空。</span><br><span class="line">MDB标准版：应用跨机房读写部分会失败，命中率下降超过<span class="number">50</span>%。</span><br><span class="line">LDB：主备模式，由GOC统一切到非故障机房进行读写。</span><br><span class="line">数据库：主备模式，<span class="number">3</span>节点分布在张北 NA61 NA62 NA63 <span class="number">3</span>机房，强一致数据同步，Leader节点所在机房故障会自动切到Follower节点进行读写。</span><br></pre></td></tr></table></figure><p>所以说整个同城容灾的精华就是“HSF同机房优先”，这里面还有一个Config server，这个Config server也是主备的，主down机之后，备cs会立即接管集群。数据库leader心跳异常后自动切到follower也是非常重要。</p><p>如果是要做容灾的演习，事前需要先跟业务约定，每次的断网只会断一个机房的网，同时发布演练计划。这样避免届时断网的时候有大量报警而产生不必要的惊慌。然后组织方需要发布演练公告，让参与的业务方SRE加入沟通群，方便及时交流。大部分SRE oncall 即可，核心领域的SRE需要现场值班。</p><p>然后组织方开始准备工作，比如白名单和打标。在注入故障的时候，就要应用的负责人和SRE通过日志和监控链接来确认“机房切换（DNS，tair和中间件）是否成功”、“自动容灾预案是否生效”、“业务的异常日志是否有预期内的收敛”以及“业务成功率是否在预期内恢复”。</p>]]></content>
    
    
    <summary type="html">设预期，勤演练，接快恢，定责轻</summary>
    
    
    
    <category term="大牛之路" scheme="http://example.com/categories/%E5%A4%A7%E7%89%9B%E4%B9%8B%E8%B7%AF/"/>
    
    
    <category term="SRE" scheme="http://example.com/tags/SRE/"/>
    
    <category term="容灾" scheme="http://example.com/tags/%E5%AE%B9%E7%81%BE/"/>
    
    <category term="稳定性" scheme="http://example.com/tags/%E7%A8%B3%E5%AE%9A%E6%80%A7/"/>
    
  </entry>
  
  <entry>
    <title>如何做好tl</title>
    <link href="http://example.com/2025/03/12/%E5%A6%82%E4%BD%95%E5%81%9A%E5%A5%BDtl/"/>
    <id>http://example.com/2025/03/12/%E5%A6%82%E4%BD%95%E5%81%9A%E5%A5%BDtl/</id>
    <published>2025-03-12T07:44:00.000Z</published>
    <updated>2025-11-08T00:47:56.300Z</updated>
    
    <content type="html"><![CDATA[<p>最近我老婆偶然间跟我聊起带人的话题，说老板考虑要让她尝试带一两个同学一起做事，她比较不情愿，原因是一旦要担负起一个团队，就意味着你的责任变了。可能同样是协同一两个同学，你在里面牵头做事，但是是TL还是PM，差别还是很大的。PM是为事情负责任的，但是TL除了为事情负责之外，更多的部分还是需要为人负责。这一部分甚至超过50%。</p><p><img data-src="/images/%E5%A6%82%E4%BD%95%E5%81%9Atl.png" title="责任的进步"></p><p>团队目前刚好也到了需要进一步从PM制走向TL制的阶段了，我在想一个小团队的重组或者新建，往往更大的挑战在于TL本身，而不是在于一线的同学。</p><p>不要把leader当做一种权利和荣耀，当你被赋予一个leader的角色的时候。更应该有的是担心和焦虑。</p><p>对于一个新的TL，或者说一个已经有经验的TL接手一个新团队，首先是先要过自己这一关。如何让自己在最短的时间里变得“笃定”，这是一个很关键的词。</p><p>笃定，并不来源于你经验的多少，或者资历的长短，p级的高低。更多的是来源于你是否能比大家看的更清楚，想的更明白。你在跟大家沟通交谈的时候，能给到大家什么样的输入。还是你看到的世界和大家也就是一样，这是两种截然不同的感觉。</p><p>口才很好，滔滔不绝，好多人觉得这种人是不是更容易被大家承认，更容易做好TL的角色。但是这只是现象，滔滔不绝可能并不能帮你获得好感，相反只会让人觉得虚伪做作。</p><p>我觉得玉伯并不是一个口才很好的人，但是并不妨碍他是一个特别厉害的TL，所以会说不是本质，传达的内容，看问题的视角，思考的角度和深度，这才是“会说”与“不会说”的差别。</p><p>不能信己，何以信人。</p><p>第二，面临一个新的团队，新的环境，新的业务，最关键的一点是如何去“立信”，前面说的是why的问题，这里是how的问题。</p><p>立信最直接的方式就是两个词“目标+胜仗”。</p><p>目标意味着清晰明确的规划，对于局势的判断，问题的梳理，明确做什么和不做什么之后得到的输出。</p><p>你能不能把当前团队的问题看清楚，局势看清楚，需要做的事情想明白，找到解法和抓手，意味着你是否能给团队带来增量的价值。</p><p>这是你是否能获得团队首肯的第一要素。</p><p>接下来就是打胜仗提气特别重要。是不是一个好将军，进战场打一仗就知道。</p><p>本地生活接手客户端团队，外卖的接手；从本地生活到五道口，三江第一家店的开张；再到后来接手盒马App团队，“愚公移山”的战役。本质上都是立信的第一场仗，决不能输~</p><p>想清楚之后就快速组织提气打仗，立军旗，进沙场拿下第一仗。这就要凭将军的硬本事了。</p><p>摇旗呐喊，打一场打胜仗对于稳定军心，立信 尤其重要，也是直接的手段。</p><p>TL一定要把大家的成长放到第一位，懂得进去带领大家，也要懂得松手留出空间。</p><p>永远不要和自己团队的同学抢功劳和成果。优秀的兵在战场上杀掉了一百个敌军，这是他的战功，Leader不能说因为是我带着他杀的，所以这一百个敌军也是我杀的。</p><p>你存在的价值是让你的团队升值，而不是分配和安排。</p>]]></content>
    
    
    <summary type="html">这不是我的文章，转载我一个前辈的思考</summary>
    
    
    
    <category term="工作与技术" scheme="http://example.com/categories/%E5%B7%A5%E4%BD%9C%E4%B8%8E%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="职场" scheme="http://example.com/tags/%E8%81%8C%E5%9C%BA/"/>
    
    <category term="管理" scheme="http://example.com/tags/%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>当我们成功的把一个业务做下线了</title>
    <link href="http://example.com/2025/03/10/%E5%BD%93%E6%88%91%E4%BB%AC%E6%88%90%E5%8A%9F%E7%9A%84%E6%8A%8A%E4%B8%80%E4%B8%AA%E4%B8%9A%E5%8A%A1%E5%81%9A%E4%B8%8B%E7%BA%BF%E4%BA%86/"/>
    <id>http://example.com/2025/03/10/%E5%BD%93%E6%88%91%E4%BB%AC%E6%88%90%E5%8A%9F%E7%9A%84%E6%8A%8A%E4%B8%80%E4%B8%AA%E4%B8%9A%E5%8A%A1%E5%81%9A%E4%B8%8B%E7%BA%BF%E4%BA%86/</id>
    <published>2025-03-10T03:20:05.000Z</published>
    <updated>2025-11-08T00:48:01.984Z</updated>
    
    <content type="html"><![CDATA[<h2 id="背景和要求"><a href="#背景和要求" class="headerlink" title="背景和要求"></a>背景和要求</h2><p>公司有一个业务计划下线，业务方已在12月就通知商家不再进行续签，并评估将于25年1月陆续下架平台内商品：1月23日商家商品全部下架，2月5日自营商品全部下架，3月31日完成了商家清退，3月31日同时下架app。然后要求在5月份左右实现相关的系统、资源也会全部下线。</p><p>跟法务、财务还有业务开了一个会，听下来，目标很简单：</p><ol><li>要求技术侧配合业务完成商品下架、商家清退、资金盘点提现等，保证业务平稳下线。</li><li>平稳下线这个业务相关的全部系统、资源，同时留存合规&amp;客服需要的离线数据。</li></ol><h2 id="具体安排"><a href="#具体安排" class="headerlink" title="具体安排"></a>具体安排</h2><ol><li><p>先根据业务的时间轴，制定出技术的时间轴。</p></li><li><p>然后对该业务的下线资源进行盘点，盘点的范围包括“应用、ecs、rds数据库、polardb、elk、redis、habase_lindorm、oss、sls、mq、cdn”等等。</p></li><li><p>应用的盘点无疑是比较麻烦的一个，要根据整个业务的功能进行梳理：<br><img data-src="/images/%E7%94%B5%E5%95%86%E4%B8%9A%E5%8A%A1.png" title="做一个电商的平台是多么的复杂"></p></li><li><p>应用和资源都梳理完毕之后，就向资源和应用的owner宣布整个下线的事宜和时间上的安排。</p></li><li><p>先动手的是一些实时的对账脚本，因为目前平台已经几乎停止交易了，只剩下几个交了钱但是还在履约的场景。所以这部分脚本停止了之后影响最小。</p></li><li><p>一些业务数据大屏可以第二步安排下线。</p></li><li><p>各方挂出公告，宣布XXX天后开始动手。</p></li><li><p>检查业务工单是否已经停止增长。</p></li><li><p>先搞交易不强相关的业务入口关闭：各种互动，逛逛等等。</p></li><li><p>然后再搞交易强相关的业务入口关闭：<br>● 首页、ND、搜索、店铺、商详：传统搜推公域与店铺私域<br>● 直播，包括直播列表、直播间、评论、宝贝口袋、主播端等：达人与店播带货的场域<br>● 百亿补贴、天猫国际、天猫超市等垂直场域<br>● BC消息（含手淘和千牛）：用户的售前、售中、售后咨询<br>● 商详、购物车、下单页、订单列表与详情（我的淘宝 -&gt; 我的订单）：交易下单<br>● 退货退款：逆向交易<br>● 会员登录：交易下单、逆向交易、消息发送、部分场域均依赖登录态</p></li><li><p>观察入口应用的流量情况，如果没有业务流量了，就开始下掉一些入口的应用，确保入口的流量（比如CDN、前端页面）先停掉。如果有流量就分析一下流量来源，逐步分批次下线容器数。这里重点看一下cdn域名关联写死了vip的情况。</p></li><li><p>不挂在应用下的资源，需要针对每种资源做下线方案，待应用下线后，再下线相关资源。</p></li></ol>]]></content>
    
    
    <summary type="html">业务买来的时候轰轰隆隆，然后下线的时候一地鸡毛</summary>
    
    
    
    <category term="工作与技术" scheme="http://example.com/categories/%E5%B7%A5%E4%BD%9C%E4%B8%8E%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="SRE" scheme="http://example.com/tags/SRE/"/>
    
    <category term="业务" scheme="http://example.com/tags/%E4%B8%9A%E5%8A%A1/"/>
    
  </entry>
  
  <entry>
    <title>如何彻底删除360</title>
    <link href="http://example.com/2025/02/22/%E5%A6%82%E4%BD%95%E5%BD%BB%E5%BA%95%E5%88%A0%E9%99%A4360/"/>
    <id>http://example.com/2025/02/22/%E5%A6%82%E4%BD%95%E5%BD%BB%E5%BA%95%E5%88%A0%E9%99%A4360/</id>
    <published>2025-02-22T14:41:05.000Z</published>
    <updated>2025-11-08T00:47:56.537Z</updated>
    
    <content type="html"><![CDATA[<p>前两天，我在尝试将微信语音转化mp3的时候，需要下载一个软件，但是不小心联同下载并安装了360。结果这个流氓软件果然在卸载之后，依旧会在电脑中有大量的残留。残留在c盘program files(x86)的360文件夹里，还随着开机启动。如果我直接删除这个文件，那么就会报“你需要来自administertors的权限才能删除”这样的提示。目前搜了一下，没有一个特别好的办法能够解决这个问题。</p><p>尝试了了半天，在csdn里有一个亲试可行的办法，来做记录和分享。</p><p>首先 <code>win+r</code> 进入运行窗口-&gt;输入<code>msconfig</code>-&gt;点击<code>引导</code>选项-&gt;选择<code>安全引导</code>-&gt;直接重启你的电脑。 重启之后你的电脑进入一个管控状态，然后找到360文件夹下的360safe文件夹，全选然后删除掉就行了。</p><p>确认都删除干净后。再次<code>win+r</code> 进入运行窗口-&gt;输入<code>msconfig</code>-&gt;点击引导选项-&gt;取消掉刚才点击的安全引导-&gt;再次重启你的电脑。你的win11就恢复正常了，同时360的内容也消失了。</p><p>最后让我骂一句，360以及周鸿祎，你们真特么的缺德，真他妈不要个脸！</p>]]></content>
    
    
    <summary type="html">从做出的软件就知道这个公司的企业文化了</summary>
    
    
    
    <category term="工作与技术" scheme="http://example.com/categories/%E5%B7%A5%E4%BD%9C%E4%B8%8E%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="360" scheme="http://example.com/tags/360/"/>
    
    <category term="流氓软件" scheme="http://example.com/tags/%E6%B5%81%E6%B0%93%E8%BD%AF%E4%BB%B6/"/>
    
    <category term="垃圾清理" scheme="http://example.com/tags/%E5%9E%83%E5%9C%BE%E6%B8%85%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>2024年终总结</title>
    <link href="http://example.com/2025/02/06/2024%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"/>
    <id>http://example.com/2025/02/06/2024%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/</id>
    <published>2025-02-06T07:35:13.000Z</published>
    <updated>2025-11-08T00:46:40.738Z</updated>
    
    <content type="html"><![CDATA[<p><img data-src="/images/2024%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93.png" title="时间分布情况"></p><h2 id="电影-电视剧-读书"><a href="#电影-电视剧-读书" class="headerlink" title="电影&amp;电视剧&amp;读书"></a>电影&amp;电视剧&amp;读书</h2><p>今年电影没少看，但是看的基本都是老片，《哪吒2》我去看了一下，只能说它是春节里面拔大个的产物，占尽了天时地利人和。在我的评价里，《哪吒》根本没啥可吹的，内核跟什么《千与千寻》、《红辣椒》简直没法比，感觉就是讲了一个伊利丹的故事，而且“你要是碰我家人，我杀你全家”这种初级黑社会打手级别的台词，让人感觉很肤浅，对于我这种快四十的人来说，“我命由我不由天”这样的鸡血台词早就免疫了。</p><p>这几个片里，我觉得很棒的有：《达拉斯买家俱乐部》、《无耻混蛋》、《暗花》、《怪物》。排名有先后，这几个无论是故事性还是镜头感都超级好的作品。尤其是《无耻混蛋》，虽然是抗德奇侠片，但是台词的讲究、镜头的运用、音乐的搭配，不得不说，只要故事讲得好，架空同人的剧本也一样受欢迎。《达拉斯卖家俱乐部》就不用说了，太经典的片子，两个男演员的演技把整部剧撑起来了。</p><p>第二梯队的是《摩加迪沙》、《卧虎藏龙》、《好东西》、《柔道龙虎榜》、《周处除三害》、《死侍与金刚狼》、《最后的里程》、《城市猎人》、《许三观》、《抓娃娃》。排名有先后，这里面《抓娃娃》是陪我爸妈春节一起看的合家欢，搞笑是挺搞笑的。但是说实话这种夸张的“中国式没苦硬吃的教育”也让我蛮震撼，尤其是马继业最后在“秘密基地”里对沈腾马丽他俩的那句“你俩是哪位老师，墙上没有你俩”。我觉得这句话，任何家长听到了都会崩溃。</p><p>《卧虎藏龙》这玩意说实话，我第一次看完后除了章子怡的凸点之外没啥特别印象了，完全不懂为啥它能拿那么多奖。后来看了几个B站的讲解，朦朦胧胧的懂了一点，但是还是没有特别深的感触，可能就是中西方文化的不同。打算2025年抽空把《一代宗师》看了，让我更加有体感一些。</p><p>《好东西》今年是一个爆款，我觉得它要是在春节档出来，票房也不会差。我觉得它这个电影里主要讲述的就是“不要在乎啥也不懂的人的看法，他们只会起哄，看法就是狗屁，自己怎么舒服怎么来才是对的”以及这个世界在某些事情上对女性的不公正。当然，其实这种不公正的偏见也很大一部分来自女性自己。“girls help girls”这话听听就得了。</p><p>至于今年读书，主要就是两本，一本《许三观卖血记》，这个是在冬天肺炎打点滴的时候，趁机会读完。整本书感觉还是蛮震撼的，余华说这本书主要讲究的是一个“公平”，我倒没觉得，我觉得讲的就是普通的没本事的中国人是怎么以最低贱的方式来面对生活中的苦难的，没权的普通人要活下来真的好难。另一本就是《金阁寺》，尤海燕先生翻译的，这个书简直就是犯罪心理文学，读起来让我感觉很舒服很孤独。而且我有段时间上班也是处于一种很压抑的心理状态里，也有一种把一切付之一炬的潜在想法。只不过《金阁寺》表达出来的更黑暗更深邃，给我留下最深印象的其实是军官在跟他的恋人分别时，恋人挤出自己的乳汁给军官喝。</p><p>电视剧的话，我今年上半年几乎一口气把传说中的神剧《绝命毒师》给看完了，果然很爽，不愧是第一美剧，看完后我深深的觉得辛爽应该看了这部剧不下20次。而我最近在啃《风骚律师》，进度没有《绝命毒师》那么快。</p><h2 id="综艺-游戏-博客"><a href="#综艺-游戏-博客" class="headerlink" title="综艺&amp;游戏&amp;博客"></a>综艺&amp;游戏&amp;博客</h2><p>今年没啥好综艺，整个大陆的综艺都在走下坡路。在朋友推荐下看了几集腾讯的《单排喜剧大赛》，没有几个特别有印象的段子，感觉就是把短视频的内容拿到了舞台上。到了淘汰赛，参赛者所有的节目质量有所下降，逐渐成了参赛者自嗨的节目了。</p><p>至于游戏，我这几年一直都是电子阳痿。啥游戏都没啥动力玩的很投入，带玩不玩的搞了一下《三国无双 起源》，这个游戏画面不错，招式绚烂，操作的手感还可以，格挡反馈也很爽。跟以往的《三国无双》不同，它其实完全可以独立坐成一个动作类游戏了，不必非要依赖三国这个背景。除此之外，我一直有蹲《对马岛之鬼》，等降价到200以内就考虑入了。</p><p>闲暇之余听的博客其实还是关注文学闲谈、讲座、哲学、足球相关的，基本那几个up主有更新就会抽空听一听。</p><h2 id="说说网络主播"><a href="#说说网络主播" class="headerlink" title="说说网络主播"></a>说说网络主播</h2><p>我在元旦的时候，无意间接触到了B站的主播。然后也看了几个女主播，也给其中几个女主播刷了礼物上了舰，不过我这个人三分钟热度，一个月后热情骤减，开始觉得看这种直播很无聊很浪费时间，也觉得这些女主播每天都要播6个小时简直就是“坐牢”。尤其是没啥人气的主播，直播间里常驻的就1～2个人，很多人来了连欢迎词都没念完就出去了。我很理解体操冠军吴柳芳说她自己没成名的时候说“自己那时候没有甚么人气，还不让玩手机，只能干坐着”。</p><p>我后来看了一了一些关注主播的文章和统计数据，不露脸只出声的女主播一般也就2～3个月就毕业了。主要是声音主播的能提供的新鲜感其实很少，只能靠不停的上新人来给新人灌入“初始的新鲜感”维持，老人听多了就腻了，自然不会继续真金白银的投入，所以这种声音主播里能活3个月的舰长都很少，更别说遇到多金的大哥了。</p><p>去年中国经济情况不好，大量工厂裁员，外加元旦和春节挨的很近，很多女学生和女工都在寒假期间进入了主播这个行业。他们99%也都签了工会，靠粉丝们打赏的流水转正，然后拿每天133元的低保，但是负责他们的运营也心知肚明这里面的女学生当主播就是来玩票的，而不露脸不擦边的主播也注定没啥大金主，所以运营肯定也会把精力用到其他更吸金的女主播里去。所以女主播自己不努力不做内容，无法给到粉丝更新的刺激，的确很难把粉丝留住。</p><p>插播一句，“擦边”这个词最近堂而皇之的被人在各种场合提起，可见“软色情”在这个经济下行的时代里，成了不少人的精神寄托。</p><p>但是毕竟B站和Uki这两个app上白嫖的粉丝居多，女主播自己也觉得自己活的像一个网络乞丐，要点礼物要做很久的心理建设。所以感觉女主播自己也慢慢转变了心态，粉丝不打赏就不互动，说了甜甜的话肯定就是找大哥要流水，不得不说进入了这个圈子后，放大了欲望，享受到了快钱，人都物质了很多。</p><p>最后补一句，uki这个app做的是真烂，语音厅的页面很烂，安装包的大小竟然要200多兆，整的手机超级卡。他们的技术应该看看淘宝才多大，B站才多大，再看看自己的优化能力。然后语音厅的那种pk玩法也是纯纯的圈粉丝钱，惩罚无非就是输的一方来一段数来宝或者是一段含水唱征服，真一点意思没有。</p><h2 id="新年的flag"><a href="#新年的flag" class="headerlink" title="新年的flag"></a>新年的flag</h2><p>flag这个东西虽然很俗气，虽然大概率还是完不成，但是出于流程，还是要立一下。</p><p>首先就是减肥，这个已经老生常谈十几年了，不过今年减肥的欲望特别旺盛，估计是因为我春节又成功了给一条牛仔裤的裤裆穿破了，实在不能再这么放纵下去了。我现在有了点小心得，目前3周用下了10斤，还要持续，争取夏天的时候能骚起来。</p><p>其次，高峰电影打算再看20部，《风骚律师》全集看完后看看《广告狂人》，书呢，打算看至少5本。</p><p>然后就是要思考，思考自己想要什么样的生活，然后开启新的生活。</p><p>2024我的家人不少都遇到了一点小坎坷，希望2025我周围的人都能平平安安。</p>]]></content>
    
    
    <summary type="html">2024也是我命里的一个小坎啊～</summary>
    
    
    
    <category term="坠乱花天" scheme="http://example.com/categories/%E5%9D%A0%E4%B9%B1%E8%8A%B1%E5%A4%A9/"/>
    
    
    <category term="年终总结" scheme="http://example.com/tags/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"/>
    
    <category term="读书" scheme="http://example.com/tags/%E8%AF%BB%E4%B9%A6/"/>
    
    <category term="电影" scheme="http://example.com/tags/%E7%94%B5%E5%BD%B1/"/>
    
  </entry>
  
  <entry>
    <title>order by limit走错了索引</title>
    <link href="http://example.com/2024/12/21/order-by-limit%E8%B5%B0%E9%94%99%E4%BA%86%E7%B4%A2%E5%BC%95/"/>
    <id>http://example.com/2024/12/21/order-by-limit%E8%B5%B0%E9%94%99%E4%BA%86%E7%B4%A2%E5%BC%95/</id>
    <published>2024-12-21T02:19:03.000Z</published>
    <updated>2025-11-08T00:47:20.985Z</updated>
    
    <content type="html"><![CDATA[<h2 id="问题和解决"><a href="#问题和解决" class="headerlink" title="问题和解决"></a>问题和解决</h2><p>今天看到这么一个sql：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from</span><br><span class="line">  restaurant_restaurant_unit this_</span><br><span class="line">where</span><br><span class="line">  this_.name LIKE &#x27;张三%&#x27;</span><br><span class="line">  and this_.restaurant_unit_type &lt;&gt; 2</span><br><span class="line">  and this_.is_valid = 1</span><br><span class="line">  and this_.status = 1</span><br><span class="line">order by</span><br><span class="line">  this_.created_at DESC </span><br><span class="line">limit</span><br><span class="line">  15;</span><br></pre></td></tr></table></figure><p>这个sql的执行时间竟然达到了令人发指的9s，这里补充一下前提知识：</p><ol><li>数据表有name的索引、<code>created_at</code>的索引，主建是id</li><li><code>is_valid</code>和<code>status</code>都可以视为有效状态</li><li><code>restaurant_unit_type</code>是节点类型，一共就3种:1是中间节点，2是叶子节点（绑定的门店），3是根节点。数据分布规模来说，2的数据远大于1和3.</li><li>sql查出来结果只有14条</li></ol><p>打开这个慢sql的工单，映入眼帘的第一个字符就是&lt;&gt;，果然数据库执行计划执行一下，结果如下：<br><img data-src="/images/%E6%85%A2sql1.png" title="走的是create_at的索引"></p><p>果然，走的是<code>create_at</code>的索引。开心的打开左边数据库信息，索引信息打开：<br><img data-src="/images/%E6%85%A2sql2.png"></p><p>结果<code>restaurant_unit_type</code>没有索引，<code>name</code>有索引，理论上是不会影响走<code>name</code>索引的呀。</p><p>既然不是&lt;&gt;导致的慢sql问题，那么到底是啥呢？凭借“菜就多练”的原则，我执行了下面几个和慢sql类似的执行计划:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sql1：去掉order by limit</span><br><span class="line">select</span><br><span class="line">  *</span><br><span class="line">from</span><br><span class="line">  restaurant_restaurant_unit this_</span><br><span class="line">where </span><br><span class="line">  this_.name &lt;&gt; &#x27;张三%&#x27;</span><br><span class="line">  and this_.restaurant_unit_type &lt;&gt; 2</span><br><span class="line">  and this_.is_valid = 1</span><br><span class="line">  and this_.status = 1;</span><br></pre></td></tr></table></figure><p>执行计划：<br><img data-src="/images/%E6%85%A2sql3.png" title="这次走的是name的索引"></p><p>这次执行时间只有8ms，快了很多。比加上<code>order by limit</code>的有了重大提高。 看来是<code>order by limit</code>导致的？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">sql2：去掉&lt;&gt;</span><br><span class="line">select</span><br><span class="line">  *</span><br><span class="line">from</span><br><span class="line">  restaurant_restaurant_unit this_</span><br><span class="line">where </span><br><span class="line">  this_.name like &#x27;张三%&#x27;</span><br><span class="line">  -- and this_.restaurant_unit_type &lt;&gt; 2  //把这个条件注释掉</span><br><span class="line">  and this_.is_valid = 1</span><br><span class="line">  and this_.status = 1</span><br><span class="line">order by</span><br><span class="line">  this_.created_at DESC</span><br><span class="line">limit</span><br><span class="line">  15;</span><br></pre></td></tr></table></figure><p>执行计划：<br><img data-src="/images/%E6%85%A2sql4.png" title="这次走的是name的索引"><br>可以看到此时并不会走<code>name</code>索引，走了<code>create_at</code>的索引，执行时间虽然有所增加，但是也远远达不到9m的程度。最后只能咨询dba的同学,dba说：<code>where语句和order by limit语句中都包含了索引列时，mysql优化器可能会选择错误的索引导致更加慢</code>。</p><p>从上面的sql也能看出，加入<code>order by limit </code>后，索引从<code>name</code>变成了<code>create_at</code>。注意的是，只是可能慢，具体慢不慢得看数据的分布情况。</p><p>分析下上面的慢sql为啥是慢sql:</p><p>首先不带<code>order by limit</code>的sql执行计划如下：<br><img data-src="/images/%E6%85%A2sql3.png" title="这里关注row这一列"></p><p>之前更多关注走索引，其实还有一个关键量，扫描行数：<code>16810</code>。</p><p>这个值是mysql优化器认为走name索引需要扫描的行数，这个是正经索引下探方法得到的值，相对准确。</p><p>但是加入<code>order by limit A </code>后，此时存在了两个索引<code>create_at</code> 和 <code>name。 </code>对于优化器来说，其目标是选择扫描行数最少的索引是最佳的，所以需要计算<code>create_at</code>的扫描行数。 而这就是问题的关键：<code>order by limit A</code> 是如何计算扫描行的。计算公式:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">统计信息里面的表行数/where语句索引的扫描行数 * limit的值A = 扫描行数</span><br></pre></td></tr></table></figure><p>根据这个公式：原理就是<code>统计信息里面的表行数/where语句索引的扫描行数</code> 就是mysql认为平均扫描一条数据的成本，再乘A就是A条数据的扫描成本。</p><p>首先获得统计信息里面的表行数：<code>2564001</code><br><img data-src="/images/%E6%85%A2sql5.png" title="这个表有250多万记录"></p><p>刚刚上面得到name索引的扫描行数：16810，而limit值为15，则计算得到：<code>2564001/16810*15 = 2287.9</code>。<br><img data-src="/images/%E6%85%A2sql1.png" title="这里关注row这一列"></p><p>这个值是远小于name索引的行，所以会走<code>create_at</code>索引。</p><p>但是为啥会慢呢？？？</p><p>原因就是因为前提说的，<code>restaurant_unit_type</code>是分布极其不均匀的。2是叶子节点为绑定的门店，都是先有叶子节点再有门店，所以叶子节点的<code>create_at</code>普遍较大，又是逆序遍历，所以基本上遍历到后面，甚至全表后才找到足够的数据。这也是为啥<code>restaurant_unit_type</code>去掉后能够较快返回的原因。</p><p>说了这么一大堆，咋解决呢？</p><p>其实问题分析下来，根本原因就是因为优化器错误的选择了<code>order by </code>后的索引嘛，那就不让他选嘛，所以就有如下的解决方案:</p><p>● 直接强force index 指定要走的索引  -》这个太粗暴了<br>● limit值扩大到上面的计算结果远大于where语句后的扫描 -》 开发阶段难以评估，且limit值大多数业务固定<br>● 不让order by 后面有索引。 –比较合理（实测有效）<br>○order by create DESC&#x2F;Asc —》order by create DESC&#x2F;ASC， id asc&#x2F;desc<br>○order by id  -》 order by id + 0</p><h2 id="另外一个参考文章"><a href="#另外一个参考文章" class="headerlink" title="另外一个参考文章"></a>另外一个参考文章</h2><p><code>order by limit</code>易走错索引，发生在<code>5.6/5.7/XDB</code>版本，这个是MYSQL设计时优化器不严谨的地方，原因如下:</p><ol><li><p>首先sql执行计划会把sql分成2部分，<code>select ...from...where...</code>作为第一部分，<code>order by...limit...</code>作为第二部分。先对<code>select ...from...where...</code>做分析，得出最佳路径<code>best_access_path</code>的索引<code>best_index</code>、扫描量<code>row_estimate_first</code>、pk的选择度<code>Cardinality_pk</code>。</p></li><li><p>当sql有<code>order by limit</code>，同时<code>limit的值&lt; best_access_path的row_estimate</code>，同时<code>order by</code>字段有单列索引或在联合索引最左列，触发执行计划<code>recheck(&quot;recheck_reason&quot;: &quot;low_limit&quot;)</code>。</p></li><li><p><code>recheck</code>后有可能选择<code>order by</code>字段的索引，如果选择了<code>order by</code>索引，同时数据分布不均匀或者实际符合条件的记录条数（即返回行数）小于limit值的话，那么就需要通过索引扫描所有的行回表，访问效率将比全表扫描还慢几倍。</p></li></ol><p>order by触发recheck具体算法如下：</p><ol><li><code>Cardinality_pk/row_estimate_first </code>获得<code>best_index</code>字段所选值平均每条记录的间距（扫描量）row_estimate_second（这里是优化器不严谨的地方，因为优化器直接认为数据是均匀分布的）</li><li>如果<code>row_estimate_second * limit值 &lt; row_estimate_first</code>,则选择<code>order by</code>字段索引，反之选择<code>best_access_path</code>索引<code>best_index</code></li></ol><p>怎么确认哪些<code>order by limit sql</code>会走错索引：</p><ol><li>对where条件的列数据量<code>group by</code>分析，确认记录最多的列值，这里记为value_a；记录limit的值，这里记为limit_b</li><li>去掉<code>order by limit</code>字段执行explain获取访问value_a的<code>best_access_path</code>索引的扫描量，这里记为<code>row_estimate_c</code></li><li>通过<code>show index from table_name</code>获取pk的选择度，这里记为Cardinality_d</li><li>如果<code>Cardinality_d/row_estimate_c*limit_b&lt;row_estimate_c</code>,即<code>Cardinality_d*limit_b&lt;row_estimate_c*row_estimate_c </code>就会触发走错索引。这里可以看出如果<code>best_access_path</code>索引访问的某个列值记录越多，即数据越不均匀，越容易触发走错索引。</li></ol><p>更快捷方式：因为value_a约等于row_estimate_c（有误差，一般2 * value_a &gt;&#x3D; row_estimate_c），方程式可以转换为：表记录数 * limit值 &lt; value_a * value_a，即只要知道表记录数，记录最多的列值，limit值，即可计算是否会走错索引（考虑误差和数据增长，建议当表记录数 * limit值 &lt; 4 * value_a * value_a即可认为会可能走错索引）。</p>]]></content>
    
    
    <summary type="html">这个问题是5.6/5.7/XDB中的一个官方Bug，在高版本中已经有所优化，不过还是会有相关的问题，了解总是好的</summary>
    
    
    
    <category term="工作与技术" scheme="http://example.com/categories/%E5%B7%A5%E4%BD%9C%E4%B8%8E%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="redis" scheme="http://example.com/tags/redis/"/>
    
    <category term="SRE" scheme="http://example.com/tags/SRE/"/>
    
    <category term="缓存" scheme="http://example.com/tags/%E7%BC%93%E5%AD%98/"/>
    
  </entry>
  
  <entry>
    <title>从杜琪峰的访谈说说香港电影</title>
    <link href="http://example.com/2024/11/05/%E4%BB%8E%E6%9D%9C%E7%90%AA%E5%B3%B0%E7%9A%84%E8%AE%BF%E8%B0%88%E8%AF%B4%E8%AF%B4%E9%A6%99%E6%B8%AF%E7%94%B5%E5%BD%B1/"/>
    <id>http://example.com/2024/11/05/%E4%BB%8E%E6%9D%9C%E7%90%AA%E5%B3%B0%E7%9A%84%E8%AE%BF%E8%B0%88%E8%AF%B4%E8%AF%B4%E9%A6%99%E6%B8%AF%E7%94%B5%E5%BD%B1/</id>
    <published>2024-11-05T09:22:32.000Z</published>
    <updated>2025-11-08T00:47:31.861Z</updated>
    
    <content type="html"><![CDATA[<h2 id="大势，与不粘锅"><a href="#大势，与不粘锅" class="headerlink" title="大势，与不粘锅"></a>大势，与不粘锅</h2><p>上周六，BBC中文放出来一段长达51分钟的杜琪峰专访。杜大导演虽然近70的年纪，在镜头面前依旧言语犀利，直言“如今的香港没有灵魂”、“政府对人民没有信心”等等惊人之语。果不其然，学啥都不行但是偏偏喜欢学朝鲜的《大公报》迫不及待的跳出来批判了他一顿，说“杜琪峰既然你能接受bbc的采访就已经是言论自由了”。《大公报》的文章转载到微博上，4个图挂了3个。</p><p>杜琪峰先生未来的境遇如何，我不清楚，反正他现在电影是带拍不拍好几年了。而且他这个论点从2019年之后也不是第一次说了，其实去年釜山电影节周润发在接受采访的时候也说过一下类似的感受。<br><img data-src="/images/%E6%9D%9C%E7%90%AA%E5%B3%B01.webp" title="枪火和黑社会养活不少的讲电影自媒体，杜sir应该找他们要钱"></p><p>不过香港电影是否还有希望复兴呢？我倒是想从我个人的角度分析一下。</p><p>首先我先说“复兴”的定义是什么？个人觉得“复兴”指的是香港电影的制作市场能重返90～93年的从业人口数，同时不仅香港本地市场票房飘红而且能在国际也有高的票房收入。这样既有质量高的电影，大家又都有钱赚才是真复兴，只有金字塔尖的人吃的饱，那叫个屁复兴。</p><p>说明了定义，再说我个人的结论：香港电影不会死，但是也肯定好不到哪里去，未来大概率是“整体行业不死不活，偶有佳作”，跟内地电影一样。<br><img data-src="/images/%E6%9D%9C%E7%90%AA%E5%B3%B04.webp" title="暗花其实就是杜琪峰拍的，梁朝伟跟他合作的最后一部电影"></p><p>以前欧洲、东南亚尤其台湾是香港电影真金白银的付费市场，最重要的是这些人作为客户不挑题材，香港拍什么他们要什么。下到三级上到文艺，从武打到搞笑，照单全收。王晶自己回忆起来都说“那段时间，赶工很夸张，很多电影都没有剧本，立项的时候除了主演和电影名，其他的啥都不知道”。正是因为有这样不挑的金主，香港电影上了风口，让香港和宝莱坞都成为了能与好莱坞齐名的电影工厂，成龙也说过“当时的电影赚钱甚至黑道都要参合一脚”。就连当时还没确立自己风格的杜琪峰自己在90～94这5年，导演了12部作品监制3部，可见当时影片市场需求之大。</p><p>当然香港也清楚自己金主爸爸的喜好，所以他们以前的很多电影里也夹杂有批评大陆的成分以满足台湾和欧洲市场。比如周润发的《赌神2》，一直到现在在大陆都是禁片。</p><p>但是随着后来台湾金主的萎靡、金融危机以及97香港回归，香港不得不面临金主从台湾转移到大陆的情况。但是大陆在2004年之前把香港电影是当外国电影看待的，无论引入量还是拍片都跟大陆电影有区别。2004年香港大陆打开了CEPA，表面上对电影放开了很多制作的限制，同时也可以30%的票房收入归香港方（原来是15%左右，但是制作上相比较严格）。但是这个CEPA明眼人都知道对香港电影最大的功劳就是“底下小公司纷纷死光，但是总体又死不透，金字塔尖的依旧还能吃”。<br><img data-src="/images/%E9%A6%99%E6%B8%AF%E7%94%B5%E5%BD%B1.jpg" title="香港贺岁档票房创下新低"></p><p>之前香港的电影有自己的审查制度，那个制度相对来说比较宽，主要是根据色情、社会议题和血腥来分级的，后来不晓得什么时候，大约是06年，国内的日本动画从各地区电视台断崖消失，香港的僵尸片、泡妞片、赌博片、监狱片也一下子被打的见不得光。香港片又要专门为大陆拍一个单独的结局，或者删掉某个片段。像03年的《大只佬》等知名的例子不说，《十月围城》里，反派胡军的手下建议“暗杀不了孙中山我们可以杀孙母”，被胡军骂了一顿，说“我们是兵不是匪”。原本这个台词是体现胡军这个角色的原则性，但是在大陆版这个片段被删除掉了。</p><p>除了题材一下子被打扁，香港电影还是延续90年代的“请大陆成名影星参演，来扩大大陆市场”的方法。记得CEPA签了不久，备受期待的《无间道3》开拍，拍完后当时骂声一片。陈道明更是用“我觉得我就是狗皮膏药”、“我的出现可能是大陆市场的标签”来表示对自己被强塞进来的不满。</p><p>那个时候其实不止陈道明，很多大陆明星都表示了对香港电影的水土不服。不过香港那时候还能靠twins、陈冠希等英皇明星来撑场，再加上后来的周杰伦（《头文字D》）延续自己的寿命，那段时间CEPA初期试水，对香港电影其实没啥实质帮助。到了08年，年度港产电影52部，09年更惨仅有49部，2010年54部，可以说一年比一年烂。</p><p>香港电影开始正式进入“小公司饿死，家大业大的能掏得出明星出场费的还算温饱”的时代。</p><p>小公司为啥会死光？最重要的是不适应大陆的文化审核制度，那些喜欢拍边缘人的、同性恋的、LGBT的、记录疫情的、记录2019的就可以靠边站了。而且没有审查不能拿到国外参展和售卖，所以香港必须只能靠拍出来大陆肯定会买的片子才能活下去，不然一切就是在烧投资人的钱。</p><p>08年是一个坎儿，不少的香港导演看清了大势，开始求变，主动北上去纳投名状。投名状纳的好的香港导演就能拿到了不少主旋律的影片执镜资格，比如林超贤先生拿到了《红海行动》。活生生的把这个片拍成了另一个《变形金刚》，2个多小时下来文戏不超过20分钟，看完后一句台词没记住，就记得林超贤先生把所有撞一起能发声响的东西都撞了一遍，在春节档这么特殊的档期拿了30多亿，美滋滋。</p><p>这里面也有拍马屁拍的不成功的，比如邱礼涛导演的《竞雄女侠 秋瑾》，原本以为可以给辛亥革命100周年献礼，结果被秋瑾的后人直接告到总理和外交部长去了，我是第一次知道原来外交部还可以管这个事儿，整个拍摄的过程其实更应该被拍成电影。</p><p>现在回头看《红海行动》、《湄公河行动》、《蛟龙行动》等等就是更大成本的流水线现代武侠片，整个流程就跟香港曾经的动作片流程一样：恶人出场作恶打破太平生活–》身手不凡正面人物出场–》经过小挫折、某某牺牲–》一场大决战、收工回家。说它是现在武侠片也是抬举它了，没啥侠气。</p><p>当然林超贤先生自己也是被逼无奈，他当初拍《湄公河行动》的时候，据说剧本被N多部门改了M回，这个涉及侦查细节不可以拍、那个涉及犯罪细节不能拍。改的他自己都受不了了，后来就只能在血腥上加点猛料，来刺激观众眼球。没办法一切都是为了过审而且赚回票房，毕竟手下人也要吃饭供房供车。<br><img data-src="/images/%E9%A6%99%E6%B8%AF%E7%94%B5%E5%BD%B1.png" title="没有好看的题材是网民认为最大的问题"></p><p>不少香港导演摸清了在大陆拍商业片的剧本套路，那就是“家国情怀+功夫特技”，或者“廉政公署整治腐败”再或者就是“在英国人统治下当二等公民的悲惨过往”，或者随机两两组合，不靠剧本细节而是纯靠特技或者情怀来卖票，反正这么玩电影质量不知道，但是绝对能签出去，再搭配上主流报纸媒体就盯着金字塔尖的成绩开始宣传这一切是“多么多么的好，多么多么的炸裂”，一年又一年的过，观众们各个看成傻子还不自知。</p><p>香港电影衰败至今，有诸多的原因，有人才原因有经济原因，而文化审查肯定是一个因素之一。因为很多优秀的电影开拍的时候就是没有剧本的，只有一个大纲，然后不断的丰富和打磨人物，让剧情真实且有深度进而成为了影坛经典。现在没有剧本大纲就想天马行空的拍，已经是不可能的了。曾经几万人就业的香港电影市场据说只剩下了几千人，当年人满为患的摄影棚如今空空如也，院线把快30年的老片拿出来重映再收割一波情怀韭菜。</p><p>2010年后香港的流行音乐和流行文化也进入了低谷期，香港品牌开始衰败、香港明星开始青黄不接,tvb已连续6年亏损。早于2019年，香港就已经不再是“机会满地的艺术中心”，以前香港是大家挤破头而来，大量非香港人能在这里创出一片天，比如马来西亚的杨紫琼、美国出生的吴彦祖、天津人林雪、哈尔滨人赵文卓、北京人刘洵先生、重庆人张晋。至于台湾人那就更多了：林青霞、舒淇、应采儿、林熙蕾、王祖贤、吴倩莲等等。现在的香港，我看委员们简直不要太多。</p><p>正如杜导演说的，现在的香港的确已经不再是当年的香港，原汁原味的香港故事已经是当地中老年人口中的传说。本身艺术家作品就是戴着脚镣跳舞的，现在又有短视频和电子游戏等同样杀时间的业余活动来挤压电影时间，面对没有新鲜血液进入这个曾繁荣的香港电影市场，面对好的港片大家且看且珍惜吧。</p><h2 id="2025年6月的补充"><a href="#2025年6月的补充" class="headerlink" title="2025年6月的补充"></a>2025年6月的补充</h2><p>3月份古天乐自曝香港电影行业到达最低谷，呼吁各影星自降片酬，可见香港的电影市场真的已经到了生死存亡的时刻。既然政策帮不了他们太多，或许他们真的需要去短视频上发力了。</p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=114228597886684&bvid=BV1dYoiYLEL7&cid=29077212658&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"></iframe><p>随着《哪吒2》的票房大火，甚至屡屡延期下线，实现了“从穿棉裤看到穿短裤”。有香港网友评论：香港的《九龙城寨》、《破地狱》也有口碑，但是中国大陆从来没有支持一部香港电影像支持《哪吒》这样。这句话背后“后妈生的”的区别待遇真是让人隔着屏幕都能感受到。</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>2009年香港电影总结：本土电影明星缺失 <a href="https://ent.sina.cn/film/2009-12-28/detail-iavxeafr7776042.d.html?from=wap">https://ent.sina.cn/film/2009-12-28/detail-iavxeafr7776042.d.html?from=wap</a><br>香港电影，我们再也回不去了 <a href="https://m.thepaper.cn/newsDetail_forward_14086808">https://m.thepaper.cn/newsDetail_forward_14086808</a><br>梁鹏飞漫谈回归20年香港电影变迁：融入内地共创华语电影辉煌 <a href="https://www.guancha.cn/LiangPengFei/2017_07_03_416175.shtml">https://www.guancha.cn/LiangPengFei/2017_07_03_416175.shtml</a><br>1995-2017：历年香港电影公司本土票房累计大PK <a href="https://www.douban.com/note/732087158/?_i=0877206mSYoyTt">https://www.douban.com/note/732087158/?_i=0877206mSYoyTt</a><br>香港电影是如何衰弱的？从殖民时代到合拍片的电影审查 <a href="https://www.youtube.com/watch?app=desktop&v=SYlA8JNgR2s">https://www.youtube.com/watch?app=desktop&amp;v=SYlA8JNgR2s</a><br>合拍片的困境 <a href="https://ent.sina.com.cn/m/2007-06-11/ba1591953.shtml">https://ent.sina.com.cn/m/2007-06-11/ba1591953.shtml</a><br>港片北上16年：香港影人奋进往事 <a href="https://mp.weixin.qq.com/s?__biz=MzIyODEzNjM4OQ==&mid=2652105739&idx=2&sn=65b0c83f0b8c61d9ef91785c93e034c1&chksm=f3b1c8a1c4c641b7d693bd1c9ef3b83d103a9f2b2b24f2787a8528b76b137511b47c4b347ef4&scene=27">https://mp.weixin.qq.com/s?__biz=MzIyODEzNjM4OQ==&amp;mid=2652105739&amp;idx=2&amp;sn=65b0c83f0b8c61d9ef91785c93e034c1&amp;chksm=f3b1c8a1c4c641b7d693bd1c9ef3b83d103a9f2b2b24f2787a8528b76b137511b47c4b347ef4&amp;scene=27</a><br>杜琪峰导演电影票房数据总汇 <a href="https://m.163.com/dy/article/H5IGE20T05527MBG.html?spss=adap_pc">https://m.163.com/dy/article/H5IGE20T05527MBG.html?spss=adap_pc</a><br>港片已死？票房惨淡倒退12年！ <a href="https://news.qq.com/rain/a/20240827A086RM00?web_channel=wap&openApp=false&suid=&media_id=">https://news.qq.com/rain/a/20240827A086RM00?web_channel=wap&amp;openApp=false&amp;suid=&amp;media_id=</a><br>無涯：杜琪峯的電影世界 <a href="https://www.bilibili.com/video/BV1tE411R7J9/?vd_source=5fc229d37e0f67862fcd1c8359f81da6">https://www.bilibili.com/video/BV1tE411R7J9/?vd_source=5fc229d37e0f67862fcd1c8359f81da6</a><br>古天乐表达了对香港电影前景的无限担忧 <a href="https://finance.sina.com.cn/stock/hyyj/2025-03-25/doc-ineqvvkw0025122.shtml">https://finance.sina.com.cn/stock/hyyj/2025-03-25/doc-ineqvvkw0025122.shtml</a></p>]]></content>
    
    
    <summary type="html">香港电影，半死不活</summary>
    
    
    
    <category term="坠乱花天" scheme="http://example.com/categories/%E5%9D%A0%E4%B9%B1%E8%8A%B1%E5%A4%A9/"/>
    
    
    <category term="电影" scheme="http://example.com/tags/%E7%94%B5%E5%BD%B1/"/>
    
    <category term="文化" scheme="http://example.com/tags/%E6%96%87%E5%8C%96/"/>
    
    <category term="香港" scheme="http://example.com/tags/%E9%A6%99%E6%B8%AF/"/>
    
  </entry>
  
</feed>
